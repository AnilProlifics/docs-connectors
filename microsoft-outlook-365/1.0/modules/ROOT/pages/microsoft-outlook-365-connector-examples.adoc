= Microsoft Outlook 365 1.0 Examples - Mule 4

The following examples show how to perform operations that interact with messages,
events, and attachment resources in Microsoft Outlook 365 Connector:

* <<create-message>>
* <<delete-message>>
* <<get-message>>
* <<list-messages>>
* <<delete-event>>
* <<create-event>>

== Prerequisites

* Java 8 or 11
* Anypoint Studio 7.5 and later
* Mule runtime engine (Mule) 4.3.0 and later
* DataWeave

[NOTE]
Some operations need prerequisite data, for example, to get a message or
an event based on its ID, you must create a message or an event first.

[[create-message]]
== Create Message

This Mule flow creates a message to send later. The message is saved in the
Drafts folder.

Here is what each operation is doing:

* *HTTP Listener* +
Accepts data from HTTP requests
* *Transform Message* +
Transforms the HTTP input used to create a message
* *Create message* +
Creates a draft of the message
* *Transform Message* +
Outputs the results of the *Create message* operation in JSON format
* *Logger* +
Shows the HTTP response from the *Create message* operation

image::create-message.png[Studio Flow for Create Message]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tableau-specialist="http://www.mulesoft.org/schema/mule/tableau-specialist" xmlns:email="http://www.mulesoft.org/schema/mule/email"
	  xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:outlook365="http://www.mulesoft.org/schema/mule/outlook365" xmlns:salesforce="http://www.mulesoft.org/schema/mule/salesforce" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/outlook365 http://www.mulesoft.org/schema/mule/outlook365/current/mule-outlook365.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/email http://www.mulesoft.org/schema/mule/email/current/mule-email.xsd
http://www.mulesoft.org/schema/mule/tableau-specialist http://www.mulesoft.org/schema/mule/tableau-specialist/current/mule-tableau-specialist.xsd">
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="7ca945b4-7657-4688-90bf-5b9b8aa9b78b" >
		<http:listener-connection host="0.0.0.0" port="8083" />
	</http:listener-config>

	<outlook365:outlook365-config name="outlook365_client_credentials" doc:name="Outlook365 Outlook365 Config" doc:id="1ae40dd0-f924-457e-b702-946d5e896ec2" >
		<outlook365:oauth-client-credentials-connection >
			<outlook365:oauth-client-credentials clientId="${oauth-client-credentials.clientId}" clientSecret="${oauth-client-credentials.clientSecret}" tokenUrl="${oauth-client-credentials.tokenUrl}" scopes="${oauth-client-credentials.scopes}" />
		</outlook365:oauth-client-credentials-connection>
	</outlook365:outlook365-config>

	<flow name="create-message" doc:id="e5a15ff1-0ded-45ae-9c20-bf71b3367edd" >
		<http:listener doc:name="Listener" doc:id="493d0ed4-3f5a-4777-ba2c-454e6e640461" path="/create-msg" config-ref="HTTP_Listener_config"/>
		<ee:transform doc:name="Transform Message" doc:id="47b52140-9bb6-4d15-9e4d-d480ebb3dcd8" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
 "subject":"Last night game - Test - Ignore please",
"importance":"Low",
"body":{
"contentType":"HTML",
"content":"They were <b>awesome</b>!"
},
"toRecipients":[
{
    "emailAddress":{
        "address":"muletest@mulesoft.com"
     }
},
{
    "emailAddress":{
        "address":"muletest@mulesoft.com"
     }
}
    ]
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<outlook365:create-message doc:name="Create message" doc:id="4723c105-b33b-40b7-a480-118e7b486f97" config-ref="outlook365_client_credentials" userId="88f176b2-84ca-4cfe-828c-954db0096efa">
		</outlook365:create-message>
		<ee:transform doc:name="Transform Message" doc:id="e23d752c-1c63-4c9b-b664-e94fa2f274fc" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="88008b17-7027-4142-a8e4-a2a59f949756" message="#[payload]"/>
	</flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `http://localhost:8083/create-msg`.


[[delete-message]]
== Delete Message

This Mule flow deletes an existing message.

Here is what each operation is doing:

* *HTTP Listener* +
Accepts data from HTTP requests
* *Delete message* +
Deletes a message from the specified user's mailbox

image::delete-message.png[Studio Flow for Delete Message]


=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tableau-specialist="http://www.mulesoft.org/schema/mule/tableau-specialist" xmlns:email="http://www.mulesoft.org/schema/mule/email"
	  xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:outlook365="http://www.mulesoft.org/schema/mule/outlook365" xmlns:salesforce="http://www.mulesoft.org/schema/mule/salesforce" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/outlook365 http://www.mulesoft.org/schema/mule/outlook365/current/mule-outlook365.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/email http://www.mulesoft.org/schema/mule/email/current/mule-email.xsd
http://www.mulesoft.org/schema/mule/tableau-specialist http://www.mulesoft.org/schema/mule/tableau-specialist/current/mule-tableau-specialist.xsd">
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="7ca945b4-7657-4688-90bf-5b9b8aa9b78b" >
		<http:listener-connection host="0.0.0.0" port="8083" />
	</http:listener-config>

	<outlook365:outlook365-config name="outlook365_client_credentials" doc:name="Outlook365 Outlook365 Config" doc:id="1ae40dd0-f924-457e-b702-946d5e896ec2" >
		<outlook365:oauth-client-credentials-connection >
			<outlook365:oauth-client-credentials clientId="${oauth-client-credentials.clientId}" clientSecret="${oauth-client-credentials.clientSecret}" tokenUrl="${oauth-client-credentials.tokenUrl}" scopes="${oauth-client-credentials.scopes}" />
		</outlook365:oauth-client-credentials-connection>
	</outlook365:outlook365-config>

	<flow name="delete-message" doc:id="f5a345c9-3adb-4371-a420-d4f103f8b514" >
		<http:listener doc:name="Listener" doc:id="2d56056f-ebb3-4759-aabe-4c0e97d5a4d9" config-ref="HTTP_Listener_config" path="/delete-msg"/>
		<outlook365:delete-message doc:name="Delete message" doc:id="98511d16-2de9-4d3e-abc3-41239eeefe36" config-ref="outlook365_client_credentials" userId="88f176b2-84ca-4cfe-828c-954db0096efa" messageId="AAMkADg5NjIxODNkLWRkNzAtNGFkNC04YjUwLWFjOTEyMzg0YzA5NgBGAAAAAADzzlN7RptORYu7QgvFkvQJBwCthX8I2XTFT5_USx5R95fIAAAAAAEPAACthX8I2XTFT5_USx5R95fIAAFXpn4vAAA="/>
	</flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `http://localhost:8083/delete-msg`.


[[get-message]]
== Get Message

This Mule flow retrieves an existing message.

Here is what each operation is doing:

* *HTTP Listener* +
Accepts data from HTTP requests
* *Get message* +
Retrieves the properties and relationships of a message object

image::get-message.png[Studio Flow for Get Message]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tableau-specialist="http://www.mulesoft.org/schema/mule/tableau-specialist" xmlns:email="http://www.mulesoft.org/schema/mule/email"
	  xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:outlook365="http://www.mulesoft.org/schema/mule/outlook365" xmlns:salesforce="http://www.mulesoft.org/schema/mule/salesforce" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/outlook365 http://www.mulesoft.org/schema/mule/outlook365/current/mule-outlook365.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/email http://www.mulesoft.org/schema/mule/email/current/mule-email.xsd
http://www.mulesoft.org/schema/mule/tableau-specialist http://www.mulesoft.org/schema/mule/tableau-specialist/current/mule-tableau-specialist.xsd">
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="7b5e348d-2f1c-4a09-b73a-7b1f84d89060" >
		<http:listener-connection host="0.0.0.0" port="8083" />
	</http:listener-config>

	<outlook365:outlook365-config name="outlook365_client_credentials" doc:name="Outlook365 Outlook365 Config" doc:id="ab1353ac-79b8-4718-a96c-a2c9e9d1d996" >
		<outlook365:oauth-client-credentials-connection >
			<outlook365:oauth-client-credentials clientId="${oauth-client-credentials.clientId}" clientSecret="${oauth-client-credentials.clientSecret}" tokenUrl="${oauth-client-credentials.tokenUrl}" scopes="${oauth-client-credentials.scopes}" />
		</outlook365:oauth-client-credentials-connection>
	</outlook365:outlook365-config>

	<flow name="get-message" doc:id="f4d095f0-3841-4b6e-b8ab-73986a37339d" >
		<http:listener doc:name="Listener" doc:id="744e331c-a530-41b2-b6a1-a7b251248578" config-ref="HTTP_Listener_config" path="/get-msg"/>
		<outlook365:get-message doc:name="Get message" doc:id="67f75fea-3c1a-4dbc-a4fe-00503d68565b" config-ref="outlook365_client_credentials" userId="88f176b2-84ca-4cfe-828c-954db0096efa" messageId="AAMkADg5NjIxODNkLWRkNzAtNGFkNC04YjUwLWFjOTEyMzg0YzA5NgBGAAAAAADzzlN7RptORYu7QgvFkvQJBwCthX8I2XTFT5_USx5R95fIAAAAAAEPAACthX8I2XTFT5_USx5R95fIAAFXpn4vAAA=" getMIMEContent="true"/>
		<logger level="INFO" doc:name="Logger" doc:id="191b1e4b-1acf-452c-b1af-62c7d14fc06d" message="#[payload]"/>
	</flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `http://localhost:8083/get-msg`.


[[list-messages]]
== List Messages

This Mule flow retrieves all of the messages.

Here is what each operation is doing:

* *HTTP Listener* +
Accepts data from HTTP requests
* *List messages* +
Retrieves messages from the signed-in user's mailbox, including messages from the Deleted Items and Clutter folders

image::list-messages.png[Studio Flow for List Messages]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tableau-specialist="http://www.mulesoft.org/schema/mule/tableau-specialist" xmlns:email="http://www.mulesoft.org/schema/mule/email"
	  xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:outlook365="http://www.mulesoft.org/schema/mule/outlook365" xmlns:salesforce="http://www.mulesoft.org/schema/mule/salesforce" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/outlook365 http://www.mulesoft.org/schema/mule/outlook365/current/mule-outlook365.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/email http://www.mulesoft.org/schema/mule/email/current/mule-email.xsd
http://www.mulesoft.org/schema/mule/tableau-specialist http://www.mulesoft.org/schema/mule/tableau-specialist/current/mule-tableau-specialist.xsd">
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="7b5e348d-2f1c-4a09-b73a-7b1f84d89060" >
		<http:listener-connection host="0.0.0.0" port="8083" />
	</http:listener-config>

	<outlook365:outlook365-config name="outlook365_client_credentials" doc:name="Outlook365 Outlook365 Config" doc:id="ab1353ac-79b8-4718-a96c-a2c9e9d1d996" >
		<outlook365:oauth-client-credentials-connection >
			<outlook365:oauth-client-credentials clientId="${oauth-client-credentials.clientId}" clientSecret="${oauth-client-credentials.clientSecret}" tokenUrl="${oauth-client-credentials.tokenUrl}" scopes="${oauth-client-credentials.scopes}" />
		</outlook365:oauth-client-credentials-connection>
	</outlook365:outlook365-config>

	<flow name="list-messages" doc:id="bd553217-a020-415a-a313-edb2cb42e551" >
		<http:listener doc:name="Listener" doc:id="b3414782-db80-40e0-895b-e7fd33109238" config-ref="HTTP_Listener_config" path="/list-messages"/>
		<outlook365:list-messages doc:name="List messages" doc:id="ebc105a3-438d-4b72-9e07-10799b760abd" config-ref="outlook365_client_credentials" userId="88f176b2-84ca-4cfe-828c-954db0096efa">
			<outlook365:o-data-query-params orderBy="createdDateTime desc" />
		</outlook365:list-messages>
		<ee:transform doc:name="Transform Message" doc:id="6cddacd2-044e-45fa-b2a0-8e0388cc4d1c" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="3a8707e4-a258-42d1-96db-3dd47f7bbf8a" message="#[payload]"/>
	</flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `http://localhost:8083/list-messages`.


[[delete-event]]
== Delete Event

This Mule flow deletes an existing created event.

Here is what each operation is doing:

* *HTTP Listener* +
Accepts data from HTTP requests
* *Delete event* +
Removes the specified event from the calendar
* *Logger* +
Shows the HTTP response from the *Delete event* operation

image::delete-event.png[Studio Flow for Delete Event]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tableau-specialist="http://www.mulesoft.org/schema/mule/tableau-specialist" xmlns:email="http://www.mulesoft.org/schema/mule/email"
	  xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:outlook365="http://www.mulesoft.org/schema/mule/outlook365" xmlns:salesforce="http://www.mulesoft.org/schema/mule/salesforce" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/outlook365 http://www.mulesoft.org/schema/mule/outlook365/current/mule-outlook365.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/email http://www.mulesoft.org/schema/mule/email/current/mule-email.xsd
http://www.mulesoft.org/schema/mule/tableau-specialist http://www.mulesoft.org/schema/mule/tableau-specialist/current/mule-tableau-specialist.xsd">
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="7b5e348d-2f1c-4a09-b73a-7b1f84d89060" >
		<http:listener-connection host="0.0.0.0" port="8083" />
	</http:listener-config>

	<outlook365:outlook365-config name="outlook365_client_credentials" doc:name="Outlook365 Outlook365 Config" doc:id="ab1353ac-79b8-4718-a96c-a2c9e9d1d996" >
		<outlook365:oauth-client-credentials-connection >
			<outlook365:oauth-client-credentials clientId="${oauth-client-credentials.clientId}" clientSecret="${oauth-client-credentials.clientSecret}" tokenUrl="${oauth-client-credentials.tokenUrl}" scopes="${oauth-client-credentials.scopes}" />
		</outlook365:oauth-client-credentials-connection>
	</outlook365:outlook365-config>

	<flow name="delete-event" doc:id="52cb41b0-d1b7-4ea6-9794-325ce76330a2" >
		<http:listener doc:name="Listener" doc:id="105e968f-dd1e-438b-ae7a-4931b143f4ec" config-ref="HTTP_Listener_config" path="/delete-event"/>
		<outlook365:delete-event doc:name="Delete event" doc:id="dbd4e75f-9380-4e83-9218-604ee5d696ec" config-ref="outlook365_client_credentials" eventId="AAMkADg5NjIxODNkLWRkNzAtNGFkNC04YjUwLWFjOTEyMzg0YzA5NgBGAAAAAADzzlN7RptORYu7QgvFkvQJBwCthX8I2XTFT5_USx5R95fIAAAAAAENAACthX8I2XTFT5_USx5R95fIAAFXpoYNAAA=" userId="88f176b2-84ca-4cfe-828c-954db0096efa"/>
		<logger level="INFO" doc:name="Logger" doc:id="81bea8fa-22ec-42e3-ac58-156fa59e8ebb" message="#[payload]"/>
	</flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `http://localhost:8083/delete-event`.


[[create-event]]
== Create Event

This Mule flow creates an event in a default user's calendar or in a specified
calendar.

Here is what each operation is doing:

* *HTTP Listener* +
Accepts data from HTTP requests
* *Create event* +
Creates an event in a default user's calendar or in a specified calendar
* *Transform Message* +
Transforms the HTTP input used to create an event
* *Logger* +
Shows the HTTP response from the *Create event* operation

image::create-event.png[Studio Flow for Create Event]
