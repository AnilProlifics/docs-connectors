= Connecting to Gmail
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:keywords: email, connector, configuration, imap, gmail, pop3


[[short_description]]
These examples provide guidance for setting up a Gmail connection using Email Connector over the available protocols.

== Gmail Configurations

By default, Google might block third-party mail clients. For Google to authorize a third-party server to access your account, you must enable the *Less Secure Apps* setting for your Gmail account. 

You can read a full explanation of the risks involved in enabling less secure apps and get a full explanation https://support.google.com/accounts/answer/6010255[here]. Essentially, Google blocks any apps that are not using security protocols that Google deems mandatory unless you allow less secure apps to access your Gmail account.

When you try to connect to your Gmail for the first time, you will receive an email that contains a link for enabling less secure apps in your Gmail account.

image::email/email-gmail-security.jpg[Email notification from Google about the blocked sign-in attempt,height=389,width=421]

You can also enable *Less Secure Apps* from *MyAccount > Sign-in & security > Connected apps & sites > Allow less secure apps*.

=== IMAP Configuration

Configure the following required parameters:

* Gmail IMAP Connection: `IMAPS Connetion`
* Gmail IMAP server address: `imap.gmail.com`
* Gmail username: Your full Gmail address (for example, +`user@gmail.com`+).
* Gmail password: Your Gmail password.
* Gmail IMAP port (SSL): `993`
* TLS Configuration: `Check insecure`

[source,xml,linenums]
----
<email:imap-config name="gmail">
  <email:imaps-connection host="imap.gmail.com"
    port="993" user="user@gmail.com"
    password="mypassword">
    <tls:context>
        <tls:trust-store insecure="true"/>
    </tls:context>
  </email:imaps-connection>
</email:imap-config>
----

=== POP3 Configuration

Configure the following required parameters:

* Gmail POP3 Connection: `POP3S Connetion`
* Gmail POP server address: `pop.gmail.com`
* Gmail username: Your full Gmail address (for example, +`user@gmail.com`+).
* Gmail password: Your Gmail password.
* Gmail POP port (SSL): `995`
* TLS Configuration: `Check insecure`

[source,xml,linenums]
----
<email:pop3-config name="gmail">
    <email:pop3s-connection host="pop.gmail.com"
      port="995"  user="user@gmail.com"
      password="mypassword">
        <tls:context>
            <tls:trust-store insecure="true"/>
        </tls:context>
    </email:pop3s-connection>
</email:pop3-config>
----

=== SMTP Configuration

Configure the following required parameters:

* Gmail SMTP Connection: `SMTPS Connetion`
* Gmail SMTP server address: `smtp.gmail.com`
* Gmail username: Your full Gmail address (for example, +`user@gmail.com`+).
* Gmail password: Your Gmail password.
* Gmail SMTP port (SSL): `465`
* TLS Configuration: `Check insecure`

[source,xml,linenums]
----
<email:smtp-config name="smtp-gmail" from="sender@gmail.com">
    <email:smtps-connection host="smtp.gmail.com"
      port="465" password="mypassword"
      user="user@gmail.com">
        <tls:context enabledProtocols="TLSv1.2,SSLv3">
            <tls:trust-store insecure="true"/>
        </tls:context>
    </email:smtps-connection>
</email:smtp-config>
----

== Troubleshoot SMTPS Connection Issues

The way you troubleshoot SMTPS connection issues depends on whether or not you have two-factor authentication set up for your Gmail account. 

If you have two-factor authentication set up:

. There is no need for you to turn *Less Secure Apps* on.
. Generate an app-specific password and use that instead of your normal password. See https://support.google.com/accounts/answer/185833[Sign in using App Password] for details.

If you do not have two-factor authentication set up:

. Enable *Less Secure Apps*.
. If using your normal password does not work, go to https://accounts.google.com/DisplayUnlockCaptcha[Allow Access to your Google Account] and:
.. Enter your username and password.
.. Enter the letters on the captcha screen.
.. Return to your Mule app and run the flow again.
