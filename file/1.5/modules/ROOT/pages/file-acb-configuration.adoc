= Using Anypoint Code Builder to Configure File Connector - Mule 4

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-connector-config-intro"]

== Creating a New Integration Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-create-integration-project"]

== Adding the Connector to Your Integration Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-add-connector-to-project"]

[[configuring-trigger]]
== Configuring the Trigger For the Flow

A trigger (source) initiates a flow when a specified condition is met.
You can configure one of these triggers to use with File Connector:

* *On New or Upated File*
+
Triggers a flow for a newly created or modified file.
* *HTTP > Listener* 
+
Initiates a flow each time it receives a request on the configured host and port
* *Scheduler* 
+
Initiates a flow when a time-based condition is met.
+
See xref:anypoint-code-builder::acb-component-scheduler.adoc[].

For example, to configure the *On New or Updated* trigger:

. Add the *On New or Updated* component to the canvas.
. Click the *On New or Updated* component on the canvas. 
. In the *General* tab, configure the following attributes:
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
|Directory |The directory where polled files are located. | No
|Recursive |Whether or not to use files contained in sub-directories. | No
|Matcher | A matcher used to filter events on files that don't meet the matcher's criteria. | No
| Watermark mode a|Select this option to pick only files that were created or updated after the last poll was executed. 

Options include:

* DISABLED
* MODIFIED_TIMESTAMP
* CREATED_TIMESTAMP | No
|Time between size check | Wait time in milliseconds between size checks to determine if a file is ready to read. This allows a file write to complete before processing. Mule runtime performs two size checks and waits the specified amount of time between calls. If both checks return the same value, the file is ready to read. | No
|Time between size check unit | Time unit for *Time between size check*.| No
|Scheduling strategy | Triggers execution of the flow based on a time-based condition. This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See <<scheduling-strategy>>. | Yes 
3+| *Post processing action* 
|Auto delete | Select this option to delete each processed file after it is processed, which causes all files obtained in the next poll to be treated as new files. | No
|Move to directory | Enter the path to the directory to send each processed file to after it processed. This is an alternative to *Auto delete* if you don't want to delete the file.| No
|Rename to | This works in tandem with *Move to directory*. Enter a file name instead of a path. The connector retains the original file name if you don't configure this field. | No
|Apply post action when failed | This option is selected (true) by default. This determines whether to apply any of the post actions (*Auto delete* and *Move to directory*) in case file processing fails. If you de-select this option, no failed files are moved or deleted. | No
|Overwrite | This option enables you to overwrite the target file when the destination file has the same name.| No
|===

[[adding-components-to-project]]
== Adding Components to Your Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-add-components-to-project"]

[[add-global-config]]
== Adding a Global Configuration

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-add-global-config"]

[[configuring-component-attributes]]
== Configuring Component Attributes

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-configure-attributes"]

=== Configuring the Copy Operation

The *Copy* operation copies the file or directory specified in *Source Path* into the *Target Path*. The source path can be either a file or a directory. If it points to a directory, then it is copied recursively.

. Click the *Copy* component on the canvas to configure the following attributes in the *General* tab:
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
| Source path | Specifies the path to the file or directory to copy. | Yes
|Target path| Target directory path to the directory to copy the file to. | Yes
|Create parent directories a|If the target path doesn't exist, and neither does its parent, then a parent folder is created if *Create parent directories* is selected. If *Create parent directories* is not used, then a `FILE:ILLEGAL_PATH` error is thrown. | No
|Overwrite |If *Overwrite* is selected and the target file already exists, then the target file is overwritten. Otherwise, a `FILE:FILE_ALREADY_EXISTS` error is thrown. | No
|Rename to |The new name for the copied file. If a new name isn't provided, the original file name is kept.| No
|===
. Click the *Advanced* tab to configure the following attributes:
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
| Error Mappings | This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See xref:mule-runtime::mule-error-concept.adoc#error-mappings. | No
+3|Connection
| Reconnection strategy| This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See xref:database-documentation.adoc#reconnect[Reconnect] and xref:database-documentation.adoc#reconnect-forever[Reconnect Forever], and <<configuring-reconnection-strategy>>. | No
|===

== 

[[scheduling-strategy]]
== Configuring the Scheduling Strategy in XML

include::connectors::partial$acb-xml-examples.adoc[tag="db-scheduling-strategy"]

[[configuring-reconnection-strategy]]
=== Configuring the Reconnection Strategy in XML

include::connectors::partial$acb-xml-examples.adoc[tag="reconnection-strategy"]