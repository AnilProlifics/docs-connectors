= Write a File Using the FTP Connector Example - Mule 4
:page-aliases: connectors::ftp/ftp-write.adoc

The Anypoint Connector for FTP (FTP Connector) *Write* operation writes content into the given path on demand.

== Configure the Write Operation in Studio

. To add and configure the *Write* operation in Studio, follow these steps:

. In the *Mule Palette* view, search for `ftp` and select *Write*.

. Drag the Write operation onto the Studio canvas.

. In the *General* tab of the operation configuration screen, click the plus sign (+) next to *Connector configuration* to access the global element configuration fields.

. Specify the connection information and click *OK*.

. In the *General* tab, set the Path field to `output.csv` to set the path of the file to write.
  By default, the connector writes whatever is in the message payload.

The following screenshot shows the *Write* operation configuration:

image::ftp-write-config.png[Write operation configuration in Studio]

In the XML editor, the `<ftp:write>` configuration looks like this:

[source,xml]
----
<ftp:write path="output.csv" />
----

== Use Embedded DataWeave Transformations

If you place a *Transform Message* component before a *Write* operation, the message payload changes, and that impacts the operation that is placed after the *Write* operation. Therefore, if the payload is in a different format and you need to transform it before writing it, you can place the transformation inside *Content* in the *Write* configuration to generate the content to be written without affecting the message in transit.

The following example places the *DataWeave* transformation in *Content*:

image::ftp-write-content.png[DataWeave transformation in the Content field of the General settings in Studio]

In the XML editor, the configuration looks like this:

[source,xml]
----
<ftp:write path="output.csv">
  <ftp:content>#[%dw 2.0
                   output application/csv
                   ---
                   payload.customers.email
                  ]
  </ftp:content>
</ftp:write>
----

However, if the payload is a different format (for example, not CSV) and you need to transform it before writing it, what do you do? If you place a Transform component before the Write operation, the message payload changes and that impacts the operation that is placed after the Write operation.

To avoid this undesired impact, you can place the transformation inside the Write operation to generate content that is written without producing a side effect on the message in transit.

The next example uses the FTP connector to write the content

[source,xml,linenums]
----
<ftp:write path="output.csv">
  <ftp:content>#[%dw 2.0
                 output application/csv
                 ---
                 payload.customers.email
                ]
  </ftp:content>
</ftp:write>
----

== Write into a Directory

The *Write* operation fails by default if you set nonexistent directories in *Path*. Set *Create parent directories* to *True (Default)* to automatically create any missing directories.

In the following example, if any of the `a`, `b`, or `c` directories set in *Path* do not exist, the connector creates them.

image::ftp-write-directories.png[Write into a directory General settings in Studio]

In the XML editor, the configuration looks like this:

[source,xml]
----
<ftp:write path="a/b/c/myFile.txt" />
----

== Write to Existing Files

When writing content to a file, set *Write Mode* to any of the following modes:

* OVERWRITE (Default)
  If the file exists, overwrite it completely.
* APPEND
  If the file exists, add its content to the end of an existing file.
* CREATE_NEW
  Create a new file. If the file already exists, then you receive an error.

== Locks

The *Write* operation supports locking similar to the *Read* operation. The main difference is that the lock releases automatically after the I *Write* operation finishes. Set *Lock* to any of the following modes:

* TRUE
* FALSE (Default)

== See Also

* xref:ftp-examples.adoc[FTP Connector Examples]
* xref:connectors::introduction/introduction-to-anypoint-connectors.adoc[Introduction to Anypoint Connectors]
* https://help.mulesoft.com[MuleSoft Help Center]
