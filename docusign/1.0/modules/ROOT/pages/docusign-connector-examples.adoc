= DocuSign 1.0 Examples - Mule 4

This example shows how to create a DocuSign envelope. The example contains two flows:

. The first flow provides a template for a user interface.
. The second flow creates the actual DocuSign envelope.

== Prerequisites

You must have:

* Anypoint Studio
* Mule runtime engine (Mule) 4.2.1 or later

== Create the First Flow

The first flow provides a template for the user interface. To change the template used in the flow,
select the *Parse Template* component and go to the *Location* field to update the location
with the path of the wanted template.

image::docusign-first-flow.png[DocuSign Connector First Flow in Studio]

In this flow, you configure:

* An HTTP *Listener* component
* *Parse Template* component

=== Configure HTTP Listener

Configure HTTP *Listener* to initiate a Mule flow when a call is made to the `/`
account path on `localhost`, port `8081`.

This example uses variables for some field values. You can either:

* Replace the variables with their values in the code.
* Provide the values for each variable in a properties file and then refer to
that file from the connector configuration.

If you don't know how to use a properties file,
see xref:mule-runtime::mule-app-properties-to-configure.adoc[Configuring Property Placeholders].

To configure HTTP *Listener*:

. Create a new Mule project in Studio.
. In *Mule Palette*, search for `http` and select the *Listener* operation:
. Drag the *Listener* operation onto the canvas.
. In the *Listener* configuration, click the *Add* icon next to the *Connector configuration*
field to add a global element.
. Click *OK* to accept the defaults.
. Set the *Path* field to `/`:

=== Add the Parse Template Component

The *Parse Template* component loads the content from your file into the Mule flow.

. Drag the *Parse Template* component onto the canvas, next to
HTTP *Listener*.
. Configure the following fields in the *Publish* properties window:
+
[%header%autowidth.spread]
|===
|Field |Value
|Display Name |Name for the component, such as `Parse Template`
|Location |Location of the file.
|===

== Create the Second Flow

The second flow creates the actual DocuSign envelope. The `status`, `emailSubject`,
`documents`, and `recipients` (combined URI and recipient URI) parameters must be provided.

image::docusign-second-flow.png[DocuSign Connector Second Flow in Studio]

In this flow, you configure:

* An HTTP *Listener* component
* *Logger* component
* *Envelopes Post Envelopes* operation
* *Transform Message* component
* A second *Logger* component

=== Configure HTTP Listener

Configure HTTP *Listener* to initiate a Mule flow when a call is made to the `/`
account path on `localhost`, port `8081`.

This example uses variables for some field values. You can either:

* Replace the variables with their values in the code.
* Provide the values for each variable in a properties file and then refer to
that file from the connector configuration.

If you don't know how to use a properties file,
see xref:mule-runtime::mule-app-properties-to-configure.adoc[Configuring Property Placeholders].

To configure HTTP *Listener*:

. Create a new Mule project in Studio.
. In *Mule Palette*, search for `http` and select the *Listener* operation:
. Drag the *Listener* operation onto the canvas.
. In the *Listener* configuration, click the *Add* icon next to the *Connector configuration*
field to add a global element.
. Click *OK* to accept the defaults.
. Set the *Path* field to `/create-envelope`:

=== Add a Logger Component

. In *Mule Palette*, search for `logger`.
. Drag the *Logger* component onto the canvas, next to the HTTP *Listener*
component.
. Configure the following fields:
+
[%header%autowidth.spread]
|===
|Field |Value
|Display Name |Name for the logger, such as `Payload Passed To The Operation Logger`
|Message |Enter `#[payload]`.
|Level |INFO (Default)
|===

=== Add the Envelopes Post Envelopes Operation

The *Envelopes Post Envelopes* operation creates an envelope from the template.

. Drag the *Envelopes Post Envelopes* operation onto the canvas, next to
the *Logger* component.
. In the *Envelopes Post Envelopes* configuration, click the
*Connector configuration* dropdown and select
*Docusign_Connector_Config*.
. Configure the following fields in the *Envelopes Post Envelopes* properties window:
+
[%header%autowidth.spread]
|===
|Field |Value
|Account Id |`${account.id}`
|Body |`payload`
|===

=== Add the Transform Message Component

The *Transform Message* component transforms the message from

. In *Mule Palette*, search for `transform message`.
. Drag the *Transform Message* component onto the canvas, next to the
*Listener* component.
. In the *Transform Message* configuration, overlay the brackets in the *Output*
section with this XML:
+
[source,xml,linenums]
----
%dw 2.0
output application/avro schemaUrl='classpath://schema.json'
---
{
	"f1": "demo_message"
}
----
