= Troubleshoot SFTP Connector

To troubleshoot Anypoint Connector for SFTP (SFTP Connector), review the following sections for performing general troubleshooting, addressing specific common errors, and interpreting commonly thrown messages.

== Troubleshoot Connectivity, Permissions and Server Side Issues

Sometimes when attempting to connect to an SFTP server you can run into issues to establish the connection because an SFTP requires a configured encrypted communication channel.
For example, you might need to enable specific encryption cyphers or key exchange algorithms, or you could indicate the location of certain authorization keys.

To resolve this issue:

. Locate the SFTP servers configuration file to review the parameters and settings regarding the connection, encryption methods, timeouts and so forth. Checking the configuration file enables you to correct configuration and customize the environment to suit your needs.
For example, if you are using OpenSSH you can access the `sshd_config` file.

. Use the configuration file to increase the logging level on the server side.

== Troubleshoot Mule Application Issues

Sometimes you are not sure why the application is failing and you require a better understanding of what is going on in the interaction with the SFTP server.

To resolve this error:

. Use the configuration file to increase the logging level on the server side.

. Try to replicate the issue using an SFTP client, for example, Cyberduck or Filezilla. If the issue also occurs with these clients, then it is likely that the issue is not related to the Mule application.

. Get better and more detailed logs on the Mule application side by enabling verbose logging for SFTP Connector and for JSCH driver:
+
.. Navigate to the log configuration file in your application and add the following lines:
+
[source,xml,linenums]
----
    <AsyncLogger name=“org.mule.extension.sftp” level=“TRACE”/>
    <AsyncLogger name=“com.jcraft.jsch” level=“DEBUG”/>
----

.. Add the following argument to your run configuration:

 -M-Djavax.net.debug=ssl,handshake

[start=4]
. Try to minimize or remove unnecessary data transformations (you could even use hard coded data) to minimize complexity and determine whether the issue is in the interaction with the SFTP server.

[[common-throws]]
== Understand Common Throws

Here is a list of common throws messages and how to interpret them.

* SFTP:ILLEGAL_PATH

 The specified path is invalid because, for example, it does not exist.

* SFTP:FILE_ALREADY_EXISTS

 An attempt made to create a file at the same location and with the same name of an already existing file.
 This happens, for example, when attempting to write a file using the CREATE_NEW write mode to the path of an already existing file.

* SFTP:ACCESS_DENIED

 An operation made an attempt to access a path at the SFTP server, and perform an action for which the user has not been granted permission.

* SFTP:FILE_LOCK

 An operation made an attempt to acquire a lock over a file, and it was unsuccessful.

* SFTP:ILLEGAL_CONTENT

 The Write operation received an invalid content to write.

* SFTP:CONNECTIVITY

 The connection to the SFTP server is interrupted.

* SFTP:INVALID_CREDENTIALS

 Authentication against SFTP server failed due to invalid credentials.

* SFTP:CONNECTION_TIMEOUT

 The connection attempt to the SFTP server timed out.

* SFTP:CANNOT_REACH

 An error occurred while attempting to establish the connection to the indicated host and port for the SFTP server. Typically, the connection is refused remotely, for example, no process is listening on the remote address or port.

* SFTP:UNKNOWN_HOST

 Can not determine the IP address of a host.

* SFTP:DISCONNECTED

 Too many failed login attempts to a server made. There could be multiple causes, but the most common one is invalid credentials.

== See Also
* https://help.mulesoft.com[MuleSoft Help Center]
* xref:sftp-connector-reference.adoc[SFTP Connector Reference]
