= Azure Event Hubs Management Connector 1.0 Examples - Mule 4

The following examples show several Mule flows for Azure Event Hubs Management Connector:

* <<create-event-hub>>
* <<update-event-hub>>
* <<create-consumer-group>>
* <<get-event-hub>>
* <<get-consumer-group>>
* <<list-eventhubs>>
* <<list-consumer-groups>>
* <<get-partition>>
* <<list-partitions>>
* <<delete-event-hub>>

== Prerequisites

* Java 8 or 11
* Anypoint Studio 7.5 and later
* Mule runtime engine (Mule) 4.3.0 and later
* DataWeave

[[create-event-hub]]
== Create an Event Hub

This Mule flow creates an Event Hub. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/eventhub`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Update or create event hub* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-1, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-1]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::create-eventhub.png[Studio Flow for the Update or create event hub operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="ba516762-cc65-45c6-b62a-0b0e6c7aeb60" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0ef86c37-d049-4110-b0a5-65ede8d60436" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b45ecad1-d2ba-4b3e-a948-ee258f1caea2" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
	<flow name="create-eventhub-demo-flow" doc:id="28055823-f6a0-4484-b245-43e3723ff560" >
		<http:listener doc:name="Event Hub Create Endpoint" doc:id="21703161-9050-4bc7-9e7f-b1337a4deb97" path="/eventhub" config-ref="HTTP_Listener_config"/>
		<azure-event-hub-management-connector:put-event-hub doc:name="Create Event Hub" doc:id="416f5c1c-e4d1-4cce-b491-f3ab71451d49" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
		</azure-event-hub-management-connector:put-event-hub>
		<ee:transform doc:name="Response to JSON" doc:id="d79cccb6-be31-440c-b8ca-27e7429227c6" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="0e76408c-31e6-4302-8c73-8b166fc6bc9c" message="#[payload]"/>
		<flow-ref doc:name="Delete Event Hub" doc:id="23017e59-cbfb-4051-9b28-e8c1dc28ab96" name="delete-subflow"/>
	</flow>
<sub-flow name="delete-subflow" doc:id="24c415c0-d89e-4ea1-b831-019defeef0ce">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="b5c48f38-1b93-4ce4-98da-a74f6ff30df0" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `http://localhost:8081/eventhub`.

[[update-event-hub]]
== Update an Event Hub

This Mule flow updates an Event Hub. You can update the message retention in the days attribute. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/eventhubupdate`
|===
* *Update or create event hub* +
Creates an Event Hub with a message retention of 3 days.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Update or create event hub* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Update or create event hub* +
Updates an Event Hub with a message retention of 6 days.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|If Match | `*`
|Body |
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>6</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Update or create event hub* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-2, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-2]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::update-eventhub.png[Studio Flow for the Update or create event hub operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="update-eventhub-demo-flow" doc:id="fc69af2f-6e58-4a46-918b-58ea4fb57268" >
  <http:listener doc:name="Event Hub Update Endpoint" doc:id="29e5966c-9746-4d12-945f-aeddef07ff13" path="/eventhubupdate" config-ref="HTTP_Listener_config"/>
  <azure-event-hub-management-connector:put-event-hub doc:name="Create event hub with message retention in days = 3" doc:id="272e28ce-7817-492e-8104-e5ece2afb93a" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
    <azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
<content type="application/xml">
  <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
    <MessageRetentionInDays>3</MessageRetentionInDays>
    <PartitionCount>8</PartitionCount>
  </EventHubDescription>
</content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
  </azure-event-hub-management-connector:put-event-hub>
  <ee:transform doc:name="Response to JSON" doc:id="745e7da8-9365-4058-a31a-727d308e5150" >
    <ee:message >
      <ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

"entry": payload.ns0#entry,

}]]></ee:set-payload>
    </ee:message>
  </ee:transform>
  <logger level="INFO" doc:name="Event Hub created" doc:id="4e0d2be1-0adc-45cb-b063-25f445217dda" message="#[payload]"/>
  <azure-event-hub-management-connector:put-event-hub doc:name="Update event hub with message retention in days = 6" doc:id="35d2d983-e27c-44a8-bee7-26ef8adcb97f" eventHubPathUriParam="/test" versionParam="2014-01" ifMatchHeader="*" config-ref="Event_Hubs_Management_Connector_Config">
    <azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
<content type="application/xml">
  <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
    <MessageRetentionInDays>6</MessageRetentionInDays>
    <PartitionCount>8</PartitionCount>
  </EventHubDescription>
</content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
  </azure-event-hub-management-connector:put-event-hub>
  <ee:transform doc:name="Transform Message" doc:id="d9e3a400-66ce-4895-b25c-aa1063351d18" >
    <ee:message >
      <ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

"entry": payload.ns0#entry,

}]]></ee:set-payload>
    </ee:message>
  </ee:transform>
  <logger level="INFO" doc:name="Event Hub updated" doc:id="ad0a50a8-f118-4b7e-a304-e77f1d5ffba7" message="#[payload]"/>
  <flow-ref doc:name="Delete Event Hub" doc:id="2e048158-24d8-4517-afb5-15e54bf15d62" name="delete-subflow"/>
</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/eventhubupdate`.

[[create-consumer-group]]
== Create a Consumer Group

This Mule flow creates and deletes a consumer group. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/consumer`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Create consumer group*
+
Creates a consumer group.
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumertest`
|Api Version | `2014-01`
|Body |
----
'<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>'
----
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Create consumer group* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-3, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-3]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::create-consumergroup.png[Studio Flow for the Update or create event hub operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="create-consumergroup-demo-flow" doc:id="d9956b8f-7bf7-45ca-93f3-8595440daa6e" >
  <http:listener doc:name="Listener" doc:id="5ae6675c-9814-4c94-98dd-88bf79a6158a" path="/consumer" config-ref="HTTP_Listener_config"/>
  <azure-event-hub-management-connector:put-event-hub doc:name="Create event hub" doc:id="61779dc5-eaaf-446d-8bfb-6bcd7416ba49" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
    <azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
<content type="application/xml">
  <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
    <MessageRetentionInDays>3</MessageRetentionInDays>
    <PartitionCount>8</PartitionCount>
  </EventHubDescription>
</content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
  </azure-event-hub-management-connector:put-event-hub>
  <azure-event-hub-management-connector:put-consumer-group doc:name="Create consumer group" doc:id="2452899d-4e78-454c-b6f1-ae699fc22e03" eventHubPathUriParam="/test" consumergroupNameUriParam="consumertest" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
    <azure-event-hub-management-connector:put-consumer-group-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
      <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
      </ConsumerGroupDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-consumer-group-body>
  </azure-event-hub-management-connector:put-consumer-group>
  <ee:transform doc:name="Response to JSON" doc:id="cb66524e-7f5e-4ba2-994b-80dfb4cc9464" >
    <ee:message >
      <ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

"entry": payload.ns0#entry,

}]]></ee:set-payload>
    </ee:message>
  </ee:transform>
  <logger level="INFO" doc:name="Logger" doc:id="f4b0002c-1bc2-4f5d-ad09-b0893baba16e" message="#[payload]"/>
  <flow-ref doc:name="Delete Event Hub" doc:id="4715de2e-da65-4962-b0f2-ac9f1bab5352" name="delete-subflow"/>
</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/consumer`.

[[get-event-hub]]
== Get an Event Hub

This Mule flow gets an Event Hub. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/geteventhub`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |+
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----

|===
* *Get event hub*
+
Retrieves all metadata associated with the specified Event Hub
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Get event hub* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-4, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-4]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::get-event-hub.png[Studio Flow for the Get event hub operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="get-eventhub-demo-flow" doc:id="3e0bffd7-907b-41a8-b850-c4a55587b675" >
		<http:listener doc:name="Listener" doc:id="baac2b22-814c-46e3-a11d-74beb31761b1" path="/geteventhub" config-ref="HTTP_Listener_config"/>
		<azure-event-hub-management-connector:put-event-hub doc:name="Create event hub" doc:id="16a3eaff-57b9-4c9b-96ac-c99681116fe5" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
		</azure-event-hub-management-connector:put-event-hub>
		<azure-event-hub-management-connector:get-event-hub doc:name="Get event hub" doc:id="cd037323-4510-421a-8dfe-375c08d79bc8" eventHubPathUriParam="/test" config-ref="Event_Hubs_Management_Connector_Config"/>
		<ee:transform doc:name="Response to JSON" doc:id="1258caec-96db-4108-a90f-39befedfae97">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

	"entry": payload.ns0#entry,

}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="fa207247-7ba4-46bb-9665-ab0d64f95d69" message="#[payload]"/>
		<flow-ref doc:name="Delete Event Hub" doc:id="c07fcd23-7bea-416d-ab60-f7cc262dabb4" name="delete-subflow"/>
	</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/geteventhub`.

[[create-consumer-group]]
== Create a Consumer Group

This Mule flow creates and deletes a consumer group. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/consumer`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Create consumer group*
+
Creates a consumer group.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|Api Version | `2014-01`
|Body |
----
'<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>'
----
|===
* *Get consumer group* +
Retrieves all metadata associated with the specified consumer group
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|===

* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Get consumer group* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Delete consumer group* +
Deletes a consumer group
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|Api Version| `2014-01`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-5, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-5]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::create-consumergroup.png[Studio Flow for the Update or create event hub operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="create-consumergroup-demo-flow" doc:id="d9956b8f-7bf7-45ca-93f3-8595440daa6e" >
  <http:listener doc:name="Listener" doc:id="5ae6675c-9814-4c94-98dd-88bf79a6158a" path="/consumer" config-ref="HTTP_Listener_config"/>
  <azure-event-hub-management-connector:put-event-hub doc:name="Create event hub" doc:id="61779dc5-eaaf-446d-8bfb-6bcd7416ba49" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
    <azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
<content type="application/xml">
  <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
    <MessageRetentionInDays>3</MessageRetentionInDays>
    <PartitionCount>8</PartitionCount>
  </EventHubDescription>
</content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
  </azure-event-hub-management-connector:put-event-hub>
  <azure-event-hub-management-connector:put-consumer-group doc:name="Create consumer group" doc:id="2452899d-4e78-454c-b6f1-ae699fc22e03" eventHubPathUriParam="/test" consumergroupNameUriParam="consumertest" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
    <azure-event-hub-management-connector:put-consumer-group-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
      <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
      </ConsumerGroupDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-consumer-group-body>
  </azure-event-hub-management-connector:put-consumer-group>
  <ee:transform doc:name="Response to JSON" doc:id="cb66524e-7f5e-4ba2-994b-80dfb4cc9464" >
    <ee:message >
      <ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

"entry": payload.ns0#entry,

}]]></ee:set-payload>
    </ee:message>
  </ee:transform>
  <logger level="INFO" doc:name="Logger" doc:id="f4b0002c-1bc2-4f5d-ad09-b0893baba16e" message="#[payload]"/>
  <flow-ref doc:name="Delete Event Hub" doc:id="4715de2e-da65-4962-b0f2-ac9f1bab5352" name="delete-subflow"/>
</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/consumer`.

[[get-consumer-group]]
== Get a Consumer Group

This Mule flow gets a consumer group. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/getconsumer`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Create consumer group*
+
Retrieves all metadata associated with the specified consumer group
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Get event hub* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-6, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-6]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::get-consumer-group.png[Studio Flow for the Get consumer group operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="get-consumergroup-demo-flow" doc:id="78e51a04-6a0f-48dc-a88f-9d47f9472a79">
		<http:listener doc:name="Listener" doc:id="15e05aaa-94ec-4db3-9dbb-2d6f04bbee12" path="/getconsumer" config-ref="HTTP_Listener_config"/>
		<azure-event-hub-management-connector:put-event-hub doc:name="Create event hub" doc:id="e2e641cb-e67b-4fdd-af43-884a99b8086c" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-event-hub-path-body><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
		</azure-event-hub-management-connector:put-event-hub>
		<azure-event-hub-management-connector:put-consumer-group doc:name="Create consumer group" doc:id="03816f36-8734-49d2-b0ec-91fc69cd17b1" eventHubPathUriParam="/test" consumergroupNameUriParam="consumer1" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-consumer-group-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>']]]></azure-event-hub-management-connector:put-consumer-group-body>
		</azure-event-hub-management-connector:put-consumer-group>
		<azure-event-hub-management-connector:get-consumer-group doc:name="Get consumer group" doc:id="83b685b6-0729-49cf-905c-6858d4658733" eventHubPathUriParam="/test" consumergroupNameUriParam="consumer1" config-ref="Event_Hubs_Management_Connector_Config"/>
		<ee:transform doc:name="Response to JSON" doc:id="a2918a75-43b2-4333-82c7-2ecc1ac6e3b3" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

	"entry": payload.ns0#entry,

}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="fcfd71d2-1a8c-4e65-a18b-ffb7e81b7771" message="#[payload]"/>
		<azure-event-hub-management-connector:delete-consumer-group doc:name="Delete consumer group" doc:id="9e3a1b95-2783-4b29-8ebc-4f5f0ee46c0b" eventHubPathUriParam="/test" consumerGroupNameUriParam="consumer1" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config"/>
		<flow-ref doc:name="Delete Event Hub" doc:id="0879487c-8d60-4b50-b758-548cea62630d" name="delete-subflow"/>
	</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/getconsumer`.

[[list-eventhubs]]
== List Event Hubs

This Mule flow gets all Event Hubs associated with a namespace. The result is displayed on the console.

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/listeventhubs`
|===
* *List event hubs* +
Retrieves all metadata associated with all Event Hubs within a specified Service Bus namespace.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{
	"entry": payload.ns0#entry,
}
----
* *Logger* +
Shows the HTTP response from the *Get event hub* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===

image::list-eventhubs.png[Studio Flow for the List event hubs operation]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="list-eventhubs-demo-flow" doc:id="9aa1764e-d26d-46ae-aa11-5563ffc30422" >
		<http:listener doc:name="Listener" doc:id="437cebad-cb06-4e98-a073-32eca0510e86" path="/listeventhubs" config-ref="HTTP_Listener_config"/>
		<azure-event-hub-management-connector:get-resources-eventhubs doc:name="List event hubs" doc:id="42cbbfb1-19ec-4da0-8644-6438838fa124" config-ref="Event_Hubs_Management_Connector_Config"/>
		<ee:transform doc:name="Response to JSON" doc:id="3e49bf6b-e27f-47db-bb27-2729a01fe617">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
---
{
	"feed": payload.ns0#feed
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="096b6a80-a22e-4438-81d4-74e8936c766b" message="#[payload]"/>
	</flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/listeventhubs`.

[[list-consumer-groups]]
== List Consumer Groups

This Mule flow gets all the consumer groups associated with an Event Hub. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/listconsumer`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Create consumer group*
+
Creates the first consumer group.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|Api Version | `2014-01`
|Body |
----
'<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>'
----
|===
* *Create consumer group*
+
Creates the second consumer group.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer2`
|Api Version | `2014-01`
|Body |
----
'<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>'
----
|===
* *List consumer groups* +
Retrieves all metadata associated with the specified consumer group
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|===

* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
---
{
	"feed": payload.ns0#feed
}
----
* *Logger* +
Shows the HTTP response from the *List consumer groups* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-7, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-7]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::list-consumergroups.png[Studio Flow for the List consumer groups operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="list-consumergroups-demo-flows" doc:id="c6c0fa15-34b9-49f3-95c6-1c96ee934c46" >
		<http:listener doc:name="Listener" doc:id="4e1abcf5-8016-4998-ba21-b574671eef1b" path="/listconsumer" config-ref="HTTP_Listener_config"/>
		<azure-event-hub-management-connector:put-event-hub doc:name="Update or create event hub" doc:id="96e38707-522d-471d-8e9e-8f62b87fbe1d" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
		</azure-event-hub-management-connector:put-event-hub>
		<azure-event-hub-management-connector:put-consumer-group doc:name="Create consumer group 1" doc:id="a5e2ee52-51bb-4487-a704-3bb524c911e4" eventHubPathUriParam="/test" consumergroupNameUriParam="consumer1" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-consumer-group-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>']]]></azure-event-hub-management-connector:put-consumer-group-body>
		</azure-event-hub-management-connector:put-consumer-group>
		<azure-event-hub-management-connector:put-consumer-group doc:name="Create consumer group 2" doc:id="622207b4-570b-4202-b50b-13d198abe845" eventHubPathUriParam="/test" consumergroupNameUriParam="consumer2" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-consumer-group-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>']]]></azure-event-hub-management-connector:put-consumer-group-body>
		</azure-event-hub-management-connector:put-consumer-group>
		<azure-event-hub-management-connector:get-consumer-groups doc:name="List consumer groups" doc:id="3bea9920-f6ee-414d-b450-80644e6d3469" eventHubPathUriParam="/test" config-ref="Event_Hubs_Management_Connector_Config"/>
		<ee:transform doc:name="Response to JSON" doc:id="2f71bad5-49b6-4953-b0cc-49870e326a81">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
---
{
	"feed": payload.ns0#feed
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="07b87905-72c1-4919-8dee-869e991e0844" message="#[payload]"/>
		<flow-ref doc:name="Delete Event Hub" doc:id="f680a1ff-f16d-4166-b6aa-7656ed6f53fe" name="delete-subflow"/>
	</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/listconsumer`.

[[get-partition]]
== Get a Partition

This Mule flow gets a partition associated with an Event Hub. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/partitionid`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Create consumer group*
+
Creates the consumer group.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|Api Version | `2014-01`
|Body |
----
'<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>'
----
|===
* *Get partition*
+
Returns the metadata for a specified partition on an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|Partition Id | `1`
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

	"entry": payload.ns0#entry,

}
----
* *Logger* +
Shows the HTTP response from the *Get partition* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-8, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-8]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::get-partition.png[Studio Flow for the Get partition operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="get-partitionid-demo-flow" doc:id="0a0fb531-85da-4405-af0d-b693657f0c2b">
		<http:listener doc:name="Listener" doc:id="83d8a2e8-9fdb-47f7-9f93-ae326c1c89ae" path="/partitionid" config-ref="HTTP_Listener_config"/>
		<azure-event-hub-management-connector:put-event-hub doc:name="Create event hub" doc:id="e676a5f8-b803-477c-b9ec-4424d49ea170" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
		</azure-event-hub-management-connector:put-event-hub>
		<azure-event-hub-management-connector:put-consumer-group doc:name="Create consumer group" doc:id="01fc9491-89f5-4998-93f7-11c8abe91cf8" eventHubPathUriParam="/test" consumergroupNameUriParam="consumer1" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-consumer-group-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>']]]></azure-event-hub-management-connector:put-consumer-group-body>
		</azure-event-hub-management-connector:put-consumer-group>
		<azure-event-hub-management-connector:get-partition doc:name="Get partition" doc:id="084176eb-de40-49e2-b03f-43f13b4b35a0" eventHubPathUriParam="test" consumergroupNameUriParam="consumer1" partitionIdUriParam="1" config-ref="Event_Hubs_Management_Connector_Config"/>
		<ee:transform doc:name="Response to JSON" doc:id="42f1483f-75f5-410a-a507-9157d203ae77" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
ns ns01 http://schemas.microsoft.com/netservices/2010/10/servicebus/connect
---
{

	"entry": payload.ns0#entry,

}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="a7355a14-82cc-497b-818d-eca578e3764a" message="#[payload]"/>
		<flow-ref doc:name="Delete Event Hub" doc:id="88dbecbd-1f19-43bf-8852-b2fdcd156ced" name="delete-subflow"/>
	</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/partitionid`.

[[list-partitions]]
== List Partitions

This Mule flow lists metadata of the partitions. The result is displayed on the console.

=== Create the First Flow

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/partitions`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Create consumer group*
+
Creates the consumer group.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|Api Version | `2014-01`
|Body |
----
'<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>'
----
|===
* *List partitions metadata*
+
Returns the metadata for all partitions on an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Consumergroup Name | `consumer1`
|===
* *Transform Message* +
Transforms the response to JSON
+
Enter the following value:
+
----
%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
---
{
	"feed": payload.ns0#feed
}
----
* *Logger* +
Shows the HTTP response from the *List partitions metadata* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `payload`
|Level | `INFO (Default)`
|===
* *Flow Reference* +
Deletes an Event Hub. References the <<delete-event-hub-9, Delete Event Hub subflow>>.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Flow name | `delete-subflow`
|Target Value | `payload`
|===

[delete-event-hub-9]
=== Create the Second Flow

This example uses the following operations:

* *Delete event hub* +
Deletes an Event Hub
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `test`
|===

image::list-partitions.png[Studio Flow for the List partitions metadata operation]

image::delete-eventhub-subflow.png[Studio Flow for the Delete event hub operation subflow]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="list-partitions-demo-flow" doc:id="2c07eb95-ca0e-461b-add0-2a8394584ef4" >
		<http:listener doc:name="Listener" doc:id="84e956be-8642-422d-a803-c5f1f1f7d996" path="/partitions" config-ref="HTTP_Listener_config"/>
		<azure-event-hub-management-connector:put-event-hub doc:name="Create event hub" doc:id="d61f24d5-31bc-4b0c-a5a6-54f38f42dd1d" eventHubPathUriParam="/test" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
		</azure-event-hub-management-connector:put-event-hub>
		<azure-event-hub-management-connector:put-consumer-group doc:name="Create consumer group" doc:id="ecb172aa-3c60-4a09-8a03-0478fd871941" eventHubPathUriParam="/test" consumergroupNameUriParam="consumer1" versionParam="2014-01" config-ref="Event_Hubs_Management_Connector_Config">
			<azure-event-hub-management-connector:put-consumer-group-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
    <content type="application/xml">
        <ConsumerGroupDescription xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        </ConsumerGroupDescription>
    </content>
</entry>']]]></azure-event-hub-management-connector:put-consumer-group-body>
		</azure-event-hub-management-connector:put-consumer-group>
		<azure-event-hub-management-connector:get-partitions doc:name="List partitions metadata" doc:id="b0f30946-33e1-4e6e-ab7c-36b7089d543c" eventHubPathUriParam="test" consumergroupNameUriParam="consumer1" config-ref="Event_Hubs_Management_Connector_Config"/>
		<ee:transform doc:name="Response to JSON" doc:id="830c29ef-2c16-44f8-8281-45cf8c1e5f08" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
ns ns0 http://www.w3.org/2005/Atom
---
{
	"feed": payload.ns0#feed
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" doc:id="05be3653-5b4e-44b2-9fff-70c8343455a3" message="#[payload]"/>
		<flow-ref doc:name="Delete Event Hub" doc:id="7a2423bd-3227-4ab9-a8fb-c12c59e1db57" name="delete-subflow"/>
	</flow>
<sub-flow name="delete-subflow" doc:id="7920f5bb-065b-4af0-a863-e4091ffd5410">
  <azure-event-hub-management-connector:delete-event-hub doc:name="Delete event Hub" doc:id="64f3c260-563d-4dd4-8b27-cfbca562dde9" eventHubPathUriParam="test" config-ref="Event_Hubs_Management_Connector_Config"/>
</sub-flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/partitions`.

[[delete-event-hub]]
== Delete an Event Hub

This Mule flow deletes an Event Hub. A successful deletion message appears on the console.

This example uses the following operations:

* *HTTP Listener* +
Accepts data from HTTP requests
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Path | `/delete`
|===
* *Update or create event hub* +
Creates an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/test`
|Api Version | `2014-01`
|Body |
[source,xml,linenums]
----
'<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>'
----
|===
* *Delete event hub*
+
Deletes an Event Hub.
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Connector configuration | `Event_Hubs_Management_Connector_Config`
|Event Hub Path | `/testdelete`
|===
* *Logger* +
Shows the HTTP response from the *Delete event hub* operation
+
Enter the following values:
+
[%header%autowidth.spread]
|===
|Field|Value
|Message | `Event Hub deleted`
|Level | `INFO (Default)`
|===

image::delete-eventhub.png[Studio Flow for the Delete event hub operation]

=== XML for This Example

Paste this code into the Studio XML editor to quickly load the flow for this example into your Mule app:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:azure-event-hub-management-connector="http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector"
	  xmlns:http="http://www.mulesoft.org/schema/mule/http"
	  xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector http://www.mulesoft.org/schema/mule/azure-event-hub-management-connector/current/mule-azure-event-hub-management-connector.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<configuration-properties doc:name="Configuration properties" doc:id="03e5822b-3325-4c56-9650-cea2e27f0758" file="mule-app.properties" />
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="0d1c1064-e368-4255-a693-2026138ee895" >
		<http:listener-connection host="0.0.0.0" port="8081" />
	</http:listener-config>
	<azure-event-hub-management-connector:config name="Event_Hubs_Management_Connector_Config" doc:name="Event Hubs Management Connector Config" doc:id="b69110c5-d1d6-47b6-b419-fbfda540b70a" >
		<azure-event-hub-management-connector:shared-access-signature-connection namespace="${sas-config.namespace}" sharedAccessKeyName="${sas-config.sharedAccessKeyName}" sharedAccessKey="${sas-config.sharedAccessKey}"/>
	</azure-event-hub-management-connector:config>
  <flow name="delete-demo-flow" doc:id="d7bef2a6-7228-4f62-9ce4-1c636a78281d" >
		<http:listener doc:name="Listener" doc:id="24310cac-a344-491e-b774-0ca0d73e8b30" config-ref="HTTP_Listener_config" path="/delete"/>
		<azure-event-hub-management-connector:put-event-hub doc:name="Update or create event hub" doc:id="ea482738-f321-415f-9ba4-3aa79df52b8d" config-ref="Event_Hubs_Management_Connector_Config" eventHubPathUriParam="/testdelete" versionParam="2014-01">
			<azure-event-hub-management-connector:put-event-hub-path-body ><![CDATA[#['<entry xmlns="http://www.w3.org/2005/Atom">
  <content type="application/xml">
    <EventHubDescription xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/netservices/2010/10/servicebus/connect">
      <MessageRetentionInDays>3</MessageRetentionInDays>
      <PartitionCount>8</PartitionCount>
    </EventHubDescription>
  </content>
</entry>']]]></azure-event-hub-management-connector:put-event-hub-path-body>
		</azure-event-hub-management-connector:put-event-hub>
		<azure-event-hub-management-connector:delete-event-hub doc:name="Delete event hub" doc:id="339a5e56-ba9d-4138-a297-86b614cdf167" config-ref="Event_Hubs_Management_Connector_Config" eventHubPathUriParam="/testdelete"/>
		<logger level="INFO" doc:name="Logger" doc:id="c6003a6e-a16a-4a6c-b90c-f68ab0b270a7" message="Event Hub deleted"/>
	</flow>
</mule>
----

=== Steps for Running This Example

. Verify that your connector is configured.
. Save the project.
. From a web browser, test the application by entering `localhost:8081/delete`.

== See Also

* xref:connectors::introduction/introduction-to-anypoint-connectors.adoc[Introduction to Anypoint Connectors]
* https://help.mulesoft.com[MuleSoft Help Center]
