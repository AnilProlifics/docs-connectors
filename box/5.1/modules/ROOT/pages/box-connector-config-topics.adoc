= Box Connector 5.1 Additional Configuration 
:page-aliases: connectors::box/box-connector-config-topics.adoc

To use Box Connector in a Mule app, configure a global Box configuration element to use by as many Box connectors as needed for your application.

== Configure the Box Connector Global Element

. Click the *Global Elements* tab at the base of the canvas.
. In the *Global Configuration Elements* screen, click *Create*.
. In the *Choose Global Type* wizard, expand Connector Configuration and select *Mule-box-connector Config* and click *OK*. +
In the configuration screen for `OAUTH 2.0` with Authorization Code, grant type displays. This is the only configuration that Box Connector supports.
. Configure the properties as described here.
+
[%header,cols="30a,70a"]
|===
|Parameter|Description
|`clientId`|Specifies the client identifier as assigned by the authorization server when the client application was registered.
|`clientSecret`|Specifies the client application's client secret.
|`host`|The host where Box exposes its API.
|`port`|The port where Box services listen for incoming requests. Default: 443
|`basePath`|The base path for the Box services' base URI.
|`protocol`|The protocol which Box services follow. Default: HTTPS
|`localCallbackPath`|The local callback path. Default: /callback
|`localCallbackConfig`|The HTTP Listener configuration that is used to configure the local authorization URL.
|`externalCallbackUrl`|The redirect URL that is configured in the client application.
|`localAuthorizationUrl`|Local authorization URL that is used to initiate an `OAuth2` dance.
|`authorizationUrl`|The authorization URL to request for an authorization code.
|`accessTokenUrl`|Specifies the URL for requesting an access token.
|===
+
In the `OAUTH 2.0` configuration screen, the placeholder values refer to a configuration file `mule-artifact.properties` placed in the
`src/main/resources` folder of your project.
+
You can either enter your credentials into the global configuration properties, or reference a configuration file that contains these values.
+
NOTE: Use a configuration file for simpler maintenance and better reusability of your project.
Keeping these values in a separate file is useful if you need to deploy to different environments where your access credentials are different, such as production, development, and QA.
+
. Click *OK*.

== JWT Authentication

* Navigate to the https://app.box.com/developers/console[Developer Console]. Select Create New App.
* Select an Custom App type
* Select the type of authentication: *Server Authentication (with JWT)*

image::box-custom-app-select.png[custom-app-selection]

* Provide the name of the application and click *Create App* 
* Navigate to *Configuration* tab and scroll down to the *OAuth 2.0 Credentials* section, where you can grab *Client Id* and *Client Secret*
* Next step is to manually generate your own *keypair* and upload *Public Key* to the https://app.box.com/developers/console[Developer Console]
* In order to create a keypair, the best way is to use https://keystore-explorer.org[KeyStore Explorer]
* When you open Keystore explorer select *Create a new keystore* and choose *JKS*

image::keystore-jks.png[keystore-jks]

* Next select the *generate keypair* icon
* Select *RSA* and *key size 2048*

image::rsa-2048.png[rsa-key-size-2048]

* Click *OK*. A modal will appear to prompt *Generate Keypair Certificate*
* In modal window leave everything as it is only click on the *Edit Name* icon

image::generate-keypair-certificate.png[generate-keypair-certificate]

image::name.png[name]

* Add all the information
* After confirmation one needs to select *new keypair entry alias*

image::keypair-alias.png[keypair-alias]

* New modal will appear where one needs to select *new keypair entry password*

image::keypair-password.png[keypair-password]

* Successfully generated Key Pair.
* Next step is to right click on the generated keypair and select *export -> export public key*

image::export-public-key.png[export-public-key]

* Save your Keystore and set password for your Keystore
* Open exported *publick key* in editor and copy all the content
* Go to https://app.box.com/developers/console[Developer Console] on the box where app is created and navigate to Configuration tab and scroll down to the section  *Add and Manage Public Keys*

image::add-public-key.png[add-public-key]

* Click *Add Public Key* button and paste all copied content from Public key
* Click *Verify and Save*
* After successful verification you will receive *Public Key Id*
* Next step is to find Entity Id and Box Sub Type: both those properties depend on your application. You can find those in the develoepr console in the tab *General Settings* under section *App Info*.

image::studio-config.png[studio-config]

== Next

Now that you have completed configuration, you can try out the Box Connector xref:box-connector-examples.adoc[Examples].

== See Also

https://help.mulesoft.com[MuleSoft Help Center]
