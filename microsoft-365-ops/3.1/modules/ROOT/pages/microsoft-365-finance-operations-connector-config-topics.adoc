= Microsoft Dynamics 365 for Finance and Operations Connector 3.1 Additional Configuration Information - Mule 4

In Microsoft Dynamics 365 for Finance and Operations Connector 3.1.7 and later, you can use custom logic to configure properties of complex types when creating entities.

== Configure Complex Types with Custom Logic

In Microsoft Dynamics 365 for Finance and Operations Connector 3.1.6 and earlier, suppose you use the following payload in the *Create* operation:

[source,json,linenums]
----
%dw 2.0
output application/java
---
{
    "Name": "GENERIC-CUSTOMER-NAME",
    "CustomerAccount": "CUSTOMER-ACCOUNT",
    "SalesCurrencyCode": "EUR",
    "CustomerGroupId": "GROUP-ID",
    "IsServiceDeliveryAddressBased": "No"
}
----

`IsServiceDeliveryAddressBased` is a property of the `Microsoft.Dynamics.DataEntities.NoYes` type. `Microsoft.Dynamics.DataEntities.NoYes` is a complex object in the Microsoft data model and is an enum type. Using this payload in the *Create* operation throws an exception because the value for `IsServiceDeliveryAddressBased` is `No`, which is a String instead of an enum type.

In Microsoft Dynamics 365 for Finance and Operations Connector 3.1.7 and later, use the newly added custom logic:

[source,json,linenums]
----
%dw 2.0
output application/java
---
{
    "Name": "GENERIC-CUSTOMER-NAME",
    "CustomerAccount": "CUSTOMER-ACCOUNT",
    "SalesCurrencyCode": "EUR",
    "CustomerGroupId": "GROUP-ID",
    "IsServiceDeliveryAddressBased": {
            "muleAdditions": {
                "kind": "enum",
                "type": "Microsoft.Dynamics.DataEntities.NoYes"
            },
            "value" : "No"
        }
}
----

The value for 'IsServiceDeliveryAddressBased' has to be an object type this time and it should contain the following:

. The key "value" and the actual value of the enum as String based on the enum type.
. The object "muleAdditions" with its two keys "kind" and "type"
.. kind - the kind of complex object that should be handled.
.. type - the actual type in the Microsoft data model.

Supported kind values:

. enum

Supported type values:

Any enum type available in Microsoft data model.
There are two ways to find out the type of the enum:
. With 3.1.7 update, metadata has been improved and now shows complete naming of a data type:

TODO: ADD enum.png image

. Execute a GET request on https://{tenant}.com/data/$metadata. The resulting xml file contains the entire data model.

== Next Step

After you complete configuring the connector, you can try the xref:connector-template-files-connector-examples.adoc[Examples].

== See Also

* xref:connectors::introduction/introduction-to-anypoint-connectors.adoc[Introduction to Anypoint Connectors]
* https://help.mulesoft.com[MuleSoft Help Center]
