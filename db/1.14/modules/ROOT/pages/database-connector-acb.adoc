////
Set connector-specific values for the following variables:

* {exchange-search-name} - Lower case term used to find the connector in Exchange. For example, redis.
* {connector-name} - Name of the connector without the word "Connector." For example, Redis.
* {version} - Connector version. For example, 1.0.
* {lc-connector-name} - Lower case connector name to use in the links in the Next Steps and See Also sections. For example, redis.
* {studio-connector-name} - Name of the connector as it appears in the Available modules section in the Studio Add Dependencies to Project window. For example, NetSuite Connector - Mule 4.
////

:exchange-search-name: <value>
:connector-name: <value>
:version: <value>
:lc-connector-name: <value>
:studio-connector-name: <value>

// Comment out the next line if the connector does not use TLS.
:tls:

// Remove comments from the next line if the connector has an Additional Configuration topic
//:additional-config:

= Using Anypoint Code Builder to Configure Database Connector - Mule 4

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-connector-config-intro"]

== Creating a New Integration Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-create-integration-project"]

== Adding the Connector to Your Integration Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-add-connector-to-project"]

[[configuring-trigger]]
== Configuring the Trigger For the Flow

A trigger (source) initiates a flow when a specified condition is met.
You can configure one of these triggers to use with Database Connector:

* *Database > On Table Row* +
Initiates a flow by selecting from a table at a regular interval and generates one message per obtained row
* *HTTP > Listener* +
Initiates a flow each time it receives a request on the configured host and port
* *Scheduler* +
Initiates a flow when a time-based condition is met.
+
xref:anypoint-code-builder::acb-component-scheduler.adoc[]

For example, to configure the *On Table Row* source:

. Add the *On Table Row* component to the canvas.
. Click the *On Table Row* component on the canvas. 
. In the *General* tab, configure the following attributes:
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
| Table | Name of the database table to select from. | Yes
| Watermark column | Values taken from this column are used to filter the contents of the next poll, so that only rows with a greater watermark value are processed. | No
|Id column |Used in conjunction with *Watermark column*, which is the name of the column to consider as the row ID. If provided, this component ensures that the same row is not processed twice by concurrent polls. | No
|Scheduling strategy | Triggers execution of the flow based on a time-based condition. This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See <<scheduling-strategy>>. | Yes
|===

. Select the *Advanced* tab to configure the following attributes:
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
|Transactional action a| Type of joining action that operations can use in transactions:

* NONE (Default)
* ALWAYS_BEGIN | No
| Transaction type | The type of transaction to create (XA or Local). Availability depends on the Mule runtime version. *Local* is the default. | No
| Primary node only |Select this option to execute the *On Table Row* trigger only on the primary node when running in a cluster. | No
| Redelivery policy | This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See xref:database-documentation.adoc#RedeliveryPolicy[Redelivery Policy]. | No
| Query timeout | Indicates the minimum amount of time before the JDBC driver attempts to cancel a running statement. By default, no timeout (`0`) is used. | No
| Query timeout unit | Select the unit of time to use. The default is SECONDS. | No
| Fetch size | Indicates how many rows to fetch from the database when rows are read from a `ResultSet`. This property is required when streaming is set to `true`, in which case a default value of `10` is used. | No
|Max rows | Sets the limit for the maximum number of rows that any `ResultSet` object generated by the message processor can contain for the given number. If the limit is exceeded, the excess rows are silently dropped. | No
|Reconnection strategy | This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See xref:database-documentation.adoc#reconnect[Reconnect] and xref:database-documentation.adoc#reconnect-forever[Reconnect Forever], and <<configuring-reconnection-strategy>>. | No
|===

[[configuring-connector-in-xml]]
== Configuring a Connector in XML
include::connectors::partial$acb-xml-maven-partial.adoc[tag="topic-intro"]
include::connectors::partial$acb-xml-maven-partial.adoc[tag="topic-add-namespace"]
include::connectors::partial$acb-xml-maven-partial.adoc[tag="pom-file"]

[[configuring-database-connection]]
== Configuring a Database Connection 

Database (Database Connector) can connect to any database for which a JDBC driver is available. The following XML examples show how to connect to the most popular databases such as Derby, Microsoft SQL Server, MySQL, Oracle, and a generic database.

[[configuring-derby]]
=== Configuring a Derby Database Connection

In the XML editor, the configuration looks like this:

[source,xml,linenums]
----
<db:config name="Database_Config" >
		<db:derby-connection database="derbyDB" />
	</db:config>
----

[[configuring-generic]]
=== Configuring a Generic Connection

In the XML editor, the configuration looks like this:

[source,xml,linenums]
----
<db:config name="Database_Config">
    <db:generic-connection driverClassName="org.h2.Driver"
    url="jdbc:h2:file:/tmp/datasenseDB"/>
</db:config>
----

[[configuring-microsoft-sql]]
=== Configuring a Microsoft SQL Server Connection

In the XML editor, the configuration looks like this:

[source,xml,linenums]
----
<db:config name="Database_Config">
    <db:mssql-connection
    host="0.0.0.0"
    port="553"
    user="Max"
    password="password"
    databaseName="microsoftDB" />
</db:config>
----

[[configuring-mysql]]
=== Configuring a MySQL Database Connection

In the XML editor, the configuration looks like this:

[source,xml,linenums]
----
<db:config name="Database_Config">
  <db:my-sql-connection
  host="0.0.0.0"
  port="3306"
  user="Max"
  password="POWERS"
  database="mysqlDB"/>
</db:config>
----

[[configuring-oracle]]
=== Configuring an Oracle Connection 

In the XML editor, the configuration looks like this:

[source,xml,linenums]
----
<db:config name="Database_Config">
  <db:oracle-connection
  host="192.168.99.100"
  port="1521" instance="xe"
  user="system"
  password="oracle" />
</db:config>
----

[[configuring-jdbc]]
== Configuring the JDBC Driver

After you configure the connections, add the JDBC driver. The following example shows how to add a driver for MySQL Database:

. Add a Maven dependency to your project's `pom.xml` file:
+
[source,xml,linenums]
----
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>5.1.48</version>
</dependency>
----
+
. Configure your `pom.xml` file so that Mule exposes the driver dependency to Database Connector:
+
[source,xml,linenums]
----
<build>
    <plugins>
        <!-- Only used to declare the shared libraries-->
        <plugin>
            <groupId>org.mule.tools.maven</groupId>
            <artifactId>mule-maven-plugin</artifactId>
            <version>1.0.0</version>
            <configuration>
                <sharedLibraries>
                    <sharedLibrary>
                        <groupId>mysql</groupId>
                        <artifactId>mysql-connector-java</artifactId>
                    </sharedLibrary>
                </sharedLibraries>
            </configuration>
        </plugin>
    </plugins>
</build>
----

[[adding-components-to-project]]
== Adding Components to Your Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-add-components-to-project"]

[[configuring-component-attributes]]
== Configuring Component Attributes

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-configure-attributes"]

[[configuring-bulk-delete]]
=== Configuring the Bulk Delete Operation

This operation enables delete operations to execute at various times using different parameter bindings and a single database statement. 

. Add the *Bulk delete* operation to the canvas.
. Click the *Bulk delete* component on the canvas. 
+
include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]

. Select the *Advanced* tab to configure the following attributes:
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
| Transactional action a| The type of joining action that operations can take for transactions:

** ALWAYS_JOIN
** JOIN_IF_POSSIBLE (Default)
** NOT_SUPPORTED | No
| Query timeout | Indicates the minimum amount of time before the JDBC driver attempts to cancel a running statement. By default, no timeout (`0`) is used. | No
| Query timeout unit | Select the unit of time to use. The default is SECONDS. | No
| Fetch size | Indicates how many rows to fetch from the database when rows are read from a `ResultSet`. This property is required when streaming is set to `true`, in which case a default value of `10` is used. | No
|Max rows | Sets the limit for the maximum number of rows that any `ResultSet` object generated by the message processor can contain for the given number. If the limit is exceeded, the excess rows are silently dropped. | No
|Parameter types | Array of xref:database-documentation.adoc#ParameterType[Parameter Type]. Use this parameter to optionally specify the type of (one or more) of the parameters in the query. If a value is provided, you're not required to reference all of the parameters. You can't reference a parameter that is not present in the input values. | No
|===

[[configure-bulk-insert]]
=== Configure the Bulk Insert Operation

This operation enables inserts to execute at various times using different parameter bindings and a single database statement. This improves performance compared to executing a single insert operation at various times.

. Add the *Bulk insert* operation to the canvas.
. Click the *Bulk insert* component on the canvas. 
include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab"]

[[configuring-bulk-update]]
=== Configuring the Bulk Update Operation

This operation enables updates to execute at various times using different parameter bindings and a single database statement. This improves performance compared to executing one single update operation at various times.

. Add the *Bulk update* operation to the canvas.
. Click the *Bulk update* component on the canvas. 
include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab"]

[[configuring-delete]]
=== Configuring the Delete Operation

This operation deletes data in a database.

include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab"]

[[configuring-execute-ddl]]
=== Configuring the Execute DDL Operation

This operation allows execution of DDL queries against a database.

. Add the *Execute DDL* operation to the canvas.
. Click the *Execute DDL* component on the canvas.
. In the *General* tab, in *SQL Query Text*, add text for the SQL query to execute. 
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab"]

[[configuring-execute-script]]
=== Configuring the Execute Script Operation

This operation executes a SQL script in a single database statement. The script is executed as you provide it, without any parameter binding.

. Add the *Execute Script* operation to the canvas.
. Click the *Execute Script* component on the canvas.
. In the *General* tab, configure the following attributes:
+
[%header%autowidth.spread]
|===
| UI Field | Description 
|SQL Query Text | Text for the SQL query to execute. 
|Script path | Specifies the location of a file to load. The file can point to a resource on the classpath or on a disk.
|===

include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab"]

[[configuring-insert]]
=== Configuring the Insert Operation 

This operation inserts data into a database.

. Add the *Insert* operation to the canvas.
. Click the *Insert* component on the canvas.
include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab-autogenerate-keys"]

[[configuring-query-single]]
=== Configuring the Query Single Operation

This operation selects a single data record from a database. If you provide a SQL query that returns more than one row, only the first record is processed and returned. This operation doesn't use streaming, which means that immediately after performing the *Query Single* operation, the complete contents of the selected record is loaded into memory.

. Add the *Query Single* operation to the canvas.
. Click the *Query Single* component on the canvas.
include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab"]

[[configuring-select-operation]]
=== Configuring the Select Operation

This operation queries data from a database. To prevent loading all the results at once, which can lead to performance and memory issues, results are streamed automatically. This means that pages of _fetchSize_ rows are loaded when needed. If this operation is performed inside a transaction (that is, within a *Try* scope component) and that transaction is closed before consuming the data, accessing the results that haven't been loaded fails.

. Add the *Select* operation to the canvas.
. Click the *Select* component on the canvas.
include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab-streaming-strategy"]

[[configuring-stored-procedure]]
=== Configuring the Stored Procedure Operation

This operation invokes a stored procedure on the database. When the stored procedure returns one or more `ResultSet` instances, results are not read all at once. Instead, results are automatically streamed to prevent performance and memory issues. This behavior means that pages of `_fetchSize_` rows are loaded lazily when needed. If the *Stored procedure* operation is performed inside a transaction (for example, in a *Try* scope component), and that transaction is closed before consuming the data, accessing the results that haven't been loaded fails.

. Add the *Stored Procedure* operation to the canvas.
. Click the *Stored Procedure* component on the canvas.
. In the *General* tab, configure the following attributes:
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
| SQL Query Text |Text of the SQL query to execute. | Yes
| Input Parameters | A map in which keys are the name of an input parameter to set on the JDBC prepared statement. Each parameter must be referenced in the SQL text using a colon prefix, for example, `where id = :myParamName`. The map's values contain the actual assignation for each parameter. | No
|Input-Output Parameters | This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See xref:database-documentation.adoc#storedProcedure[Stored Procedure]. | No
| Output Parameters | This attribute is not currently enabled in the configuration UI. Configure it in the XML editor. See xref:database-documentation.adoc#storedProcedure[Stored Procedure]. | No
|===
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab-autogenerate-keys"]

[[configuring-update-operation]]
=== Configuring the Update Operation

This operation updates data in a database. 

. Add the *Update* operation to the canvas.
. Click the *Update* component on the canvas.
include::connectors::partial$acb-config-db-general-tab.adoc[tag="general-tab-attributes"]
include::connectors::partial$acb-config-db-general-tab.adoc[tag="advanced-tab-autogenerate-keys"]

[[xml-examples]]
== XML Examples

[[configuring-reconnection-strategy]]
=== Configuring the Reconnection Strategy in XML

include::connectors::partial$acb-xml-examples.adoc[tag="reconnection-strategy"]

[[configuring-streaming-strategy]]
=== Configuring the Streaming Strategy in XML

You can configure how Mule handles streams with streaming strategies.

include::connectors::partial$acb-xml-examples.adoc[tag="streaming-strategy"]

[[scheduling-strategy]]
=== Configuring the Scheduling Strategy in XML

include::connectors::partial$acb-xml-examples.adoc[tag="db-scheduling-strategy"]

[[create-new-config-xml]]
== Create a New Configuration XML File

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-create-config-file-acb"]

== See Also

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-template-see-also"]
* xref:database-documentation.adoc[Database Connector Reference]
* xref:mule-runtime::streaming-about.adoc[Configure Streaming Strategies]


