= Azure Key Vault Connector 1.0 Reference - Mule 4

Anypoint Connector for Azure Key Vault (Azure Key Vault Connector) enables you to retrieve secrets, keys, or certificates, and encrypt or decrypt content.


[[Config]]
== Configuration

Default Configuration for Azure Key Vault Connector.


[%header,cols="20s,25a,30a,15a,10a"]
|===
| Name | Type | Description | Default Value | Required
|Name | String | Name for this configuration. Connectors reference the configuration with this name. | | x
| Connection a| <<Config_Connection, Connection>>
 | Connection types for this configuration. | | x
| Name a| String |  ID used to reference this configuration. |  | x
| Expiration Policy a| <<ExpirationPolicy>> |  Configures the minimum amount of time that a dynamic configuration instance can remain idle before Mule considers it eligible for expiration.   |  |
|===

[[Config_Connection]]
=== Connection - Connection Type

Uses a client ID, client secret, and cryptography client cache for authentication.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Name | Type | Description | Default Value | Required
| Client Id a| String | Client ID. |  | x
| Tenant Id a| String | Tenant ID. |  | x
| Client Secret a| String | Client secret. |  | x
| Vault Name a| String | Vault name. |  | x
| Cryptography Client Cache a| <<CachedCryptographyClientConfiguration>> |  The cryptography client is created based on a key. If the key does not change (no new versions are created), the client is cached and the *Encrypt Message* and *Decrypt Message* operations take less time. |  |
| Reconnection a| <<Reconnection>> |  Configures a reconnection strategy to use when a connector operation fails to connect to an external server. |  |
| Pooling Profile a| <<PoolingProfile>> |  Characteristics of the connection pool. |  |
|===

== Operations

* <<DecryptMessage>>
* <<EncryptMessage>>
* <<GetCertificate>>
* <<GetSecret>>

[[DecryptMessage]]
=== Decrypt Message
`<azure-key-vault:decrypt-message>`

Decrypts a message.


[%header,cols="20s,25a,30a,15a,10a"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Algorithm a| Enumeration, one of:

** RSA_OAEP
** RSA_OAEP_256
** RSA1_5 | Algorithm type. |  | x
| Key Name a| String | Key name. |  | x
| Key Version a| String | Key version. |  |
| Message a| Any | Message to decrypt. |  `#[payload]` |
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Target Variable a| String |  Name of the variable that stores the operation’s output. |  |
| Target Value a| String |  Expression that evaluates the operation’s output. The outcome of the expression is stored in the *Target Variable* field. |  `#[payload]` |
| Reconnection Strategy a| * <<Reconnect>>
* <<ReconnectForever>> |  Retry strategy in case of connectivity errors. |  |
|===

==== Output

[%autowidth.spread]
|===
|Type |<<CryptographyResult>>
|===

==== Associated Configurations

* <<Config>>

==== Throws

* AZURE-KEY-VAULT:CONNECTIVITY
* AZURE-KEY-VAULT:DECRYPT_ERROR
* AZURE-KEY-VAULT:ENCRYPT_ERROR
* AZURE-KEY-VAULT:INVALID_CREDENTIALS
* AZURE-KEY-VAULT:INVALID_VAULT
* AZURE-KEY-VAULT:RESOURCE_NOT_FOUND
* AZURE-KEY-VAULT:RETRY_EXHAUSTED


[[EncryptMessage]]
=== Encrypt Message
`<azure-key-vault:encrypt-message>`

Encrypts a message.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Algorithm a| Enumeration, one of:

** RSA_OAEP
** RSA_OAEP_256
** RSA1_5 | Algorithm type. |  | x
| Key Name a| String | Key name. |  | x
| Key Version a| String | Key version. |  |
| Message a| Any | Message to encrypt. |  `#[payload]` |
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Target Variable a| String |  Name of the variable that stores the operation’s output. |  |
| Target Value a| String |  Expression that evaluates the operation’s output. The outcome of the expression is stored in the *Target Variable* field. |  `#[payload]` |
| Reconnection Strategy a| * <<Reconnect>>
* <<ReconnectForever>> |  Retry strategy in case of connectivity errors. |  |
|===

==== Output

[%autowidth.spread]
|===
|Type |<<CryptographyResult>>
|===

==== Associated Configurations

* <<Config>>

==== Throws

* AZURE-KEY-VAULT:CONNECTIVITY
* AZURE-KEY-VAULT:DECRYPT_ERROR
* AZURE-KEY-VAULT:ENCRYPT_ERROR
* AZURE-KEY-VAULT:INVALID_CREDENTIALS
* AZURE-KEY-VAULT:INVALID_VAULT
* AZURE-KEY-VAULT:RESOURCE_NOT_FOUND
* AZURE-KEY-VAULT:RETRY_EXHAUSTED


[[GetCertificate]]
=== Get Certificate
`<azure-key-vault:get-certificate>`

Retrieves a certificate.


[%header,cols="20s,25a,30a,15a,10a"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Certificate Name a| String | Certificate name. |  | x
| Certificate Version a| String | Certificate version. |  |
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Target Variable a| String |  Name of the variable that stores the operation’s output. |  |
| Target Value a| String |  Expression that evaluates the operation’s output. The outcome of the expression is stored in the *Target Variable* field. |  `#[payload]` |
| Reconnection Strategy a| * <<Reconnect>>
* <<ReconnectForever>> |  Retry strategy in case of connectivity errors. |  |
|===

==== Output

[%autowidth.spread]
|===
|Type |<<VaultCertificate>>
|===

==== Associated Configurations

* <<Config>>

==== Throws

* AZURE-KEY-VAULT:CONNECTIVITY
* AZURE-KEY-VAULT:DECRYPT_ERROR
* AZURE-KEY-VAULT:ENCRYPT_ERROR
* AZURE-KEY-VAULT:INVALID_CREDENTIALS
* AZURE-KEY-VAULT:INVALID_VAULT
* AZURE-KEY-VAULT:RESOURCE_NOT_FOUND
* AZURE-KEY-VAULT:RETRY_EXHAUSTED


[[GetSecret]]
=== Get Secret
`<azure-key-vault:get-secret>`

Retrieves a secret.


[%header,cols="20s,25a,30a,15a,10a"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Secret Name a| String | Secret name. |  | x
| Secret Version a| String | Secret version. |  |
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Target Variable a| String |  Name of the variable that stores the operation’s output. |  |
| Target Value a| String |  Expression that evaluates the operation’s output. The outcome of the expression is stored in the *Target Variable* field. |  `#[payload]` |
| Reconnection Strategy a| * <<Reconnect>>
* <<ReconnectForever>> |  Retry strategy in case of connectivity errors. |  |
|===

==== Output

[%autowidth.spread]
|===
|Type |<<VaultSecret>>
|===

==== Associated Configurations

* <<Config>>

==== Throws

* AZURE-KEY-VAULT:CONNECTIVITY
* AZURE-KEY-VAULT:DECRYPT_ERROR
* AZURE-KEY-VAULT:ENCRYPT_ERROR
* AZURE-KEY-VAULT:INVALID_CREDENTIALS
* AZURE-KEY-VAULT:INVALID_VAULT
* AZURE-KEY-VAULT:RESOURCE_NOT_FOUND
* AZURE-KEY-VAULT:RETRY_EXHAUSTED



== Object Types



[[CachedCryptographyClientConfiguration]]
=== Cached Cryptography Client Configuration

Configures the cached cryptography client configuration.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Cached Crypto Client Ttl a| String | Cached crypto client time-to-live (TTL) value. | `10` |
| Unit a| Enumeration, one of:

** NANOSECONDS
** MICROSECONDS
** MILLISECONDS
** SECONDS
** MINUTES
** HOURS
** DAYS | Time unit for the *Cached Crypto Client Ttl* field. | `MINUTES` |
|===

[[Reconnection]]
=== Reconnection

Configures a reconnection strategy for an operation.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Fails Deployment a| Boolean | Configures a reconnection strategy to use when a connector operation fails to connect to an external server. |  |
| Reconnection Strategy a| * <<Reconnect>>
* <<ReconnectForever>> | Reconnection strategy to use. |  |
|===

[[Reconnect]]
=== Reconnect

Configures a standard reconnection strategy, which specifies how often to reconnect and how many reconnection attempts the connector source or operation can make.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Frequency a| Number | How often to attempt to reconnect, in milliseconds. |  |
| Blocking a| Boolean | If `false`, the reconnection strategy runs in a separate, non-blocking thread. |  |
| Count a| Number | How many reconnection attempts the Mule app can make. |  |
|===

[[ReconnectForever]]
=== Reconnect Forever

Configures a forever reconnection strategy by which the connector source or operation attempts to reconnect at a specified frequency for as long as the Mule app runs.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Frequency a| Number | How often to attempt to reconnect, in milliseconds. |  |
| Blocking a| Boolean | If `false`, the reconnection strategy runs in a separate, non-blocking thread. |  |
|===

[[PoolingProfile]]
=== Pooling Profile

Configures the pooling profile type.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Max Active a| Number | Controls the maximum number of Mule components that can be borrowed from a session at one time. When set to a negative value, there is no limit to the number of components that may be active at one time. When maxActive is exceeded, the pool is said to be exhausted. |  |
| Max Idle a| Number | Controls the maximum number of Mule components that can sit idle in the pool at any time. When set to a negative value, there is no limit to the number of Mule components that may be idle at one time. |  |
| Max Wait a| Number | Specifies the number of milliseconds to wait for a pooled component to become available when the pool is exhausted and the exhaustedAction is set to WHEN_EXHAUSTED_WAIT. |  |
| Min Eviction Millis a| Number | Determines the minimum amount of time an object may sit idle in the pool before it is eligible for eviction. When non-positive, no objects will be evicted from the pool due to idle time alone. |  |
| Eviction Check Interval Millis a| Number | Specifies the number of milliseconds between runs of the object evictor. When non-positive, no object evictor is executed. |  |
| Exhausted Action a| Enumeration, one of:

** WHEN_EXHAUSTED_GROW
** WHEN_EXHAUSTED_WAIT
** WHEN_EXHAUSTED_FAIL | Specifies the behavior of the Mule component pool when the pool is exhausted. Possible values are: "WHEN_EXHAUSTED_FAIL", which will throw a NoSuchElementException, "WHEN_EXHAUSTED_WAIT", which will block by invoking Object.wait(long) until a new or idle object is available, or WHEN_EXHAUSTED_GROW, which will create a new Mule instance and return it, essentially making maxActive meaningless. If a positive maxWait value is supplied, it will block for at most that many milliseconds, after which a NoSuchElementException will be thrown. If maxThreadWait is a negative value, it will block indefinitely. |  |
| Initialisation Policy a| Enumeration, one of:

** INITIALISE_NONE
** INITIALISE_ONE
** INITIALISE_ALL | Determines how components in a pool should be initialized. The possible values are: INITIALISE_NONE (will not load any components into the pool on startup), INITIALISE_ONE (will load one initial component into the pool on startup), or INITIALISE_ALL (will load all components in the pool on startup) |  |
| Disabled a| Boolean | Whether pooling should be disabled |  |
|===

[[ExpirationPolicy]]
=== Expiration Policy

Configures an expiration policy strategy.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Max Idle Time a| Number | Configures the maximum amount of time that a dynamic configuration instance can remain idle before Mule considers it eligible for expiration. |  |
| Time Unit a| Enumeration, one of:

** NANOSECONDS
** MICROSECONDS
** MILLISECONDS
** SECONDS
** MINUTES
** HOURS
** DAYS | Time unit for the *Max Idle Time* field. |  |
|===

[[CryptographyResult]]
=== Cryptography Result

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Data a| Binary |  |  |
| Encryption Algorithm a| Enumeration, one of:

** RSA_OAEP
** RSA_OAEP_256
** RSA1_5 |  |  |
| Key a| String |  |  |
|===

[[VaultCertificate]]
=== Vault Certificate

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Certificate a| Binary |  |  |
| Certificate Content Type a| String |  |  |
| Certificate Key Type a| String |  |  |
| Certificate Secret a| <<VaultSecret>> |  |  |
| Certificate Type a| String |  |  |
| Created On a| DateTime |  |  |
| Enabled a| Boolean |  |  |
| Expires On a| DateTime |  |  |
| Key Id a| String |  |  |
| Name a| String |  |  |
| Not Before a| DateTime |  |  |
| Recovery Level a| String |  |  |
| Secret Id a| String |  |  |
| Updated On a| DateTime |  |  |
| Version a| String |  |  |
|===

[[VaultSecret]]
=== Vault Secret

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Content Type a| String |  |  |
| Created On a| DateTime |  |  |
| Enabled a| Boolean |  |  |
| Expires On a| DateTime |  |  |
| Id a| String |  |  |
| Name a| String |  |  |
| Not Before a| DateTime |  |  |
| Recovery Level a| String |  |  |
| Updated On a| DateTime |  |  |
| Value a| String |  |  |
| Version a| String |  |  |
|===
