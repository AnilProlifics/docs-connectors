= Configure the Java Module Using Anypoint Code Builder

Use the Java module in your Anypoint Code Builder project to define custom Java code. To use Anypoint Code Builder to configure the Java module, create a basic integration project in Anypoint Code Builder, add connectors and other components to your Mule application to process your business logic, and then configure the attributes for the Java Module. 

== Before You Begin

Before creating an Anypoint Code Builder integration project, you must:

* xref:anypoint-code-builder::start-acb.adoc[Set up and access the Anypoint Code Builder web or desktop IDE]
* Have credentials to access Anypoint Platform
* Ensure that the Visual Studio Code Extension Pack for Java is installed.

[[creating-new-integration-project]]
== Creating a New Integration Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-create-integration-project"]

When you create a new Anypoint Code Builder project, `src/main/java` and `/src/test/java` folders are created. For existing projects, you can manually create this folder. 

== Creating a Java Class and Adding Methods

Create Java classes containing methods to use in your application flows. The classes you create in your project are not available to other projects in your Anypoint Code Builder workspace.

. In your Anypoint Code Builder project, create a new Java package under `src/main/java`.
. Create a new Java class, and add the implementation, for example:
+
[source,java,linenums]
----
package com.me;

public class TaxCalculator {

    private Double percentBaseTax = 7.0;

    public Double calculateTax(Double price, Integer percentAdditionalTax) {
        return price * (this.percentBaseTax + percentAdditionalTax) / 100;
    }

    public Boolean isTaxFree(Double price) {
        if (price < 10) {
            return true;
        }
        return false;
    }
}
---- 

[[add-components]]
== Add Components to Your Project

Add components to your integration project to build a flow:

. In the *Explorer* view, open the XML file for your project if it's not already open.
. Select *Build a Flow* from the start card to create an empty flow:
+
image:connectors::acb-build-flow.png["Canvas UI with starting card with the option to start from scratch, build a flow, or build a subflow"]
+
. Change the name of the flow: 
.. Click *Flow*. 
.. Click the edit icon. 
+
image:connectors::acb-change-flow-name.png["Arrow pointing to the flow name edit pencil icon"]
+
.. Enter the flow name, and click the checkmark. 

[[configuring-http-trigger]]
== Configuring the Trigger For the Flow

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-configure-source"]

[[adding-components-to-project]]
== Adding Components to Your Project

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-add-components-to-project"]

[[configuring-component-attributes]]
== Configuring the Component Attributes

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-configure-attributes"]

[[configuring-new]]
=== Configuring the New Operation

Create a new instance of a class by using the *New* operation of the Java module. The identifier of a constructor includes the class and constructor names, and the constructor has a full description of its signature including the types of each parameter.

For example, to invoke the constructor `Me(String name, int age)` which belongs to the `org.bar.Me` class, then the identifier of the method is `Me(String,int)`.

To configure the attributes for *New* in the Anypoint Code Builder UI:

. Click the *New* component on the canvas.
. In the *General* tab:
.. Select the *Class* that contains the method to use.
.. Select the *Method* to use. 
. Select the *Advanced* tab to configure the following attributes: 
+
[%header%autowidth.spread]
|===
| UI Field | Description | Required
| Target variable | Name of the variable to assign the instance to. | No
| Target value | Expression that evaluates the operation's output. The expression outcome is stored in the target variable. | No
| Error mappings | This attribute is not currently enabled in the UI. Set of error mappings. | No
|===
. Select the *Input/Output* tab to filter and view input and output data for the *Invoke* operation.

After you add your instance, <<configuring-invoke,configure the *Invoke* operation>>.

[[configuring-invoke]]
=== Configuring the Invoke Operation

Invoke methods with the provided arguments in an instance. The identifier of the method to invoke includes the class and method names.

To configure the attributes for *Invoke* in the Anypoint Code Builder UI:

. Click the *Invoke* component on the canvas.
. In the *General* tab:
.. Select the *Instace* on which the method is invoked.
.. Select the *Class* that contains the method to use.
.. Select the *Method* to use. 
include::connectors::partial$acb-java-module-partial.adoc[tag="advanced-tab-attributes"]

[[configuring-invoke-static]]
=== Configuring the Invoke Static Operation

Invoke static methods with the arguments you provide. 

To configure the attributes for *Invoke* in the Anypoint Code Builder UI:

. Click the *Invoke Static* component on the canvas.
. In the *General* tab:
.. Select the *Class* that contains the method to use.
.. Select the *Method* to use. 
include::connectors::partial$acb-java-module-partial.adoc[tag="advanced-tab-attributes"]

=== Configuring the Validate Type Operation

Use this operation to validate that an instance is an `instanceof` a class.

. Click the *Validate type* component on the canvas.
. In the *General* tab:
.. Select the *Class* that contains the method to use.
.. Select the *Instace* on which the method is invoked.
.. Select *Accept subtypes* to accept subtypes of a class. 
+
Unselect this option if the instance has to be of the exact same class.


== See Also

include::connectors::partial$configure-acb-connectors-partial.adoc[tag="acb-template-see-also"]
xref:java-reference.adoc[Java Module Reference]





