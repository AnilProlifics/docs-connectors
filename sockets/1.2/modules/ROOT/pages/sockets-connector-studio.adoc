= Use Studio to Configure Sockets Connector 1.2 - Mule 4

Anypoint Studio (Studio) editors help you design and update your Mule applications, properties, and configuration files.

To add and configure a connector in Studio:

. <<create-mule-project,Create a Mule project>>.
. <<add-connector-to-project,Add the connector to your Mule project>>.
. <<configure-input-source,Configure Socket Listener source for the connector's flow>>.
. <<add-connector-operation, Configure Send and Receive Operations in the flow>>.
. <<configure-global-element,Configure a global element for the connector>>.
. <<configure-other-fields,Configure Supported Protocols>>.


If you are new to configuring connectors in Studio, see xref:connectors::introduction/intro-config-use-studio.adoc[Use Studio to Configure a Connector]. If, after reading this topic, you need additional information about the connector fields, see the <link to the connector Reference Guide [<connector name> Reference].

[[create-mule-project]]
== Create a Mule Project

In Studio, create a new Mule project in which to add and configure the connector:

. In Studio, select *File > New > Mule Project*.
. Enter a name for your Mule project and click *Finish*.


[[add-connector-to-project]]
== Add the Connector to Your Mule Project

Add Sockets Connector to your Mule project to automatically populate the XML code with the connector's namespace and schema location and add the required dependencies to the project's `pom.xml` file:

. In the *Mule Palette* view, click *(X) Search in Exchange*.
. In *Add Modules to Project*, type `Sockets` in the search field.
. Click *Sockets* in *Available modules*.
. Click *Add*.
. Click *Finish*.

Adding a connector to a Mule project in Studio does not make that connector available to other projects in your Studio workspace.


[[configure-input-source]]
== Configure Socket Listener

An input source initiates a flow when a specified condition is met
The Socket Listener operation represents a socket endpoint that clients can connect to. By browsing to this endpoint, external clients establish a TCP Socket connection and trigger the flow each time they send a message.

. In the *Mule Palette* view, select *Socket* > *Listener*.
. Drag *Listener* to the Studio canvas.
. On the *Listener* configuration screen, optionally change the value of the *Display Name* field.
. Click the plus sign (+) next to the *Connector configuration* field to configure a global element that can be used by all instances of `Socket Listener` in the app.
. On the *General* tab, set the *Host* and *Port* required attributes.
. On the *Buffer Configuration* tab, optionally specify send and receive buffer size information.
. On the *TLS* tab, optionally specify TLS information.
. On the *Timeout Configuration* tab, optionally specify client and server timeout information.
. On the *Advanced* tab, optionally specify reconnection information, including a reconnection strategy.
. Click *Test Connection* to confirm that Mule can connect with the specific server.
. Click *OK*.

In Studio, configuring the Socket Listener to accept local incoming connections on port `8082`, looks as follows:

.Socket Listener Configuration
image::socket-listener-configuration.png[Socket Listener Configuration]

In the *Configuration XML* tab, the XML looks as follows:

[source,xml,linenums]
----
	<sockets:listener-config name="SocketsListenerConfig">
		<sockets:tcp-listener-connection host="localhost" port="8082" />
	</sockets:listener-config>
----


== Configure Send and Receive Operations

When you add a connector operation to your flow, you immediately define a specific operation for that connector to perform. Sockets Connector provides two basic operations:

 * Send +
 Sends the data using the client associated to the RequesterConnection.
 * Send and Receive
 Sends the data using the client associated and then blocks until a response is received or the timeout is met, in which case the operation will return a null payload.




== Configure Supported Protocols

Sockets Connector supports these TCP protocols:

* Direct Protocol +
  The socket reads until no more bytes are (immediately) available. On slow networks, `EOFProtocol` and `LengthProtocol` might be more reliable.
* EOF Protocol +
  Reading is terminated by the stream being closed by the client.
* Length Protocol +
  This protocol is defined by sending or reading an integer (the packet length) and then the data to be transferred.
* Custom Class Loading Length Protocol +
  A length protocol that uses a specific class loader to load objects from streams.
* Safe Protocol +
  A test protocol that precedes every message with a cookie, and should not be used in production environments.
* Streaming Protocol +
  Allows the socket's Send operation to return a message with the original `InputStream` as payload.
* XML Message Protocol +
  The `XmlMessageProtocol` is a protocol used to read streaming XML documents. The only requirement is that each document includes an XML declaration at the beginning of the document of the form "<?xml...". Make sure that the XML documents being streamed begin with an XML declaration when using this protocol. +
  Data is read until a new document is found or until there is no more currently available data. For slower networks, `XmlMessageEofProtocol` might be more reliable. +
  Also, because the default character encoding for the platform is used to decode the message bytes when looking for the XML declaration, some caution with message character encodings is warranted
* XML Message EOF Protocol +
  Extends `XmlMessageProtocol` to continue reading until either a new message or EOF is found.
* Custom Protocol +
  Define your own custom protocol by writing a class that extends `TcpProtocol`.

These application level protocols are implemented on top of TCP. For these protocols to work properly, implement these in both client and server ends.

By default, a socket implements Safe Protocol, but you can specify a different protocol in the `config` element. The following example, demonstrates how to configure the socket to use Direct Protocol:

[source,xml,linenums]
----
	<sockets:listener-config name="Sockets_Listener_config" doc:name="Sockets Listener config" >
		<sockets:tcp-listener-connection host="localhost" port="8082" >
			<sockets:protocol>
				<sockets:direct-protocol />
			</sockets:protocol>
		</sockets:tcp-listener-connection>
	</sockets:listener-config>
----
