= Publish Messages to an MQTT Broker with MQTT3 Connector

In these examples, you configure the Anypoint Connector for MQTT3 (MQTT3 Connector) *Publish* (`<mqtt3:publish>`) operation that enables you to publish a message to the desired topic (`topic`) and with a specific quality of service (`qos`).

In the Configuration XML editor, the `<mqtt3:publish>` and `topic` configurations look like this:

[source,xml,linenums]
----
<mqtt3:config name="MQTT_Config">
    <<mqtt3:connection clientId="smart-bentley-123" username="usertest" password="passtest" url="tcp://127.0.0.1:1883"/>
</mqtt3:config>

<flow name="publishQuote">
    <http:listener config-ref="HTTP_Listener" path="/mqtt3/publish" />
    <mqtt3:publish config-ref="MQTT_Config" topic="quotes/terryPratchett" qos="AT_LEAST_ONCE" isRetained="true">
        <mqtt3:message>#["Stories of imagination tend to upset those without one."]</mqtt3:message>
    </mqtt3:publish>
</flow>
----

== Mark Messages as Retained

By default, a broker discards a received message on a topic for which there are no current subscribers. Although, the broker retains the message if you configure the `isRetained` parameter to `true`. The broker stores the last retained message and the corresponding quality of service for the selected topic. +
Each client that subscribes to a topic pattern that matches the topic of the retained message receives the retained messages after they subscribe. The broker stores only one retained message per topic. This enables new subscribers to receive the most current value rather than waiting for the next update from a publisher.

== See Also

* xref:mqtt3-connector-examples.adoc[MQTT3 Connector Examples]
* https://help.mulesoft.com[MuleSoft Help Center]
