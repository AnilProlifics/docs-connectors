= Configure Tracing Module Logging Variables Operations

The Tracing module *Clear logging variables*, *Remove logging variable* and *Set logging variables* operations enable you to enhance your logs by adding, removing, and clearing variables from the logging context for a given Mule event. The logging context exists for the entire execution of the corresponding event.

Mapped Diagnostic Context (MDC) enriches logging and improves tracking by providing more context or information in the logs for the current Mule event. By default, Mule logs two MDC entries: `processor`, which shows the location of the current event, and `event`, which shows the correlation ID of the event.

== Prerequisites

To use the Tracing module logging operations, complete the following tasks:

* Install the Tracing module in your application.
* Change the pattern layouts in the `log4j.xml` file to `MDC`.

== Install the Tracing Module

Follow the next steps to install the Tracing module in your application.

. Open your Mule project in Anypoint Studio.
. Go to *Mule Palette*.
. Select *Search in Exchange*, and search for `tracing`.
. Select the module and click *Add*.
. Click *Finish*.

== Change the Pattern Layouts in the log4j.xml File

This change instructs Mule to automatically add the MDC context, which includes the correlation ID and the processor path. You can modify the `log4j.xml` file of your Mule app or the file of your Mule instance, which is located in `/conf/log4j2.xml`.

Follow these steps to change the pattern layouts to MDC:

. Open the `log4j.xml` file for editing.
. Replace `[processor: %X{processorPath}; event: %X{correlationId}]` with `[%MDC]`.

=== Example log4j.xml File Configurations

.Example: Default log4j.xml file without MDC logging.
----
<PatternLayout pattern="%-5p %d [%t] [processor: %X{processorPath}; event: %X{correlationId}] %c: %m%n"/>
----

.Example: Updated log4j.xml file with MDC logging.
----
<PatternLayout pattern="%-5p %d [%t] [%MDC] %c: %m%n"/>
----

== Configure Tracing Module Operations in Studio

To configure the logging variables operations, add any of the available operations *Clear logging variables*, *Remove logging variable* or *Set logging variables* to your Mule app flow and specify the corresponding attributes.

In the following example, you configure the *Set logging variables* operation:

. In Studio, navigate to the *Mule Palette* and search `tracing`.
. Drag *Set logging variables* to your Mule app.
. Set *Variable name* to `testVar`.
. Set *Value* to `testValue`.

image::tracing-module-set-logging-variable.png[Set logging variable operation configuration window]

In the Configuration XML editor, the `<tracing:set-logging-variable>` configuration looks like this:

[source,xml,linenums]
----
<flow name="exmapleFlow">
    ...
    <tracing:set-logging-variable variableName="testVar" value="testValue" />
    ...
</flow>
----

After executing the flow, the output logs are:
----
INFO  2021-04-08 16:58:26,882 [[MuleRuntime].uber.15: [test-project-app].exmapleFlow.CPU_LITE @18f679] [{correlationId=c85e16c0-98a4-11eb-bc34-cac765a2219b, processorPath=exmapleFlow/processors/2, testVar=testValue}] org.mule.runtime.core.internal.processor.LoggerMessageProcessor: Example
----

The previous logging context affects any output of a *Logger* component and any internal logging that Mule runtime engine produces. Therefore, you can add more context to the event that Mule is processing if you need additional information for tracking down any potential issue, for example, when an unexpected error occurs.



== See Also

* xref:tracing-module-examples.adoc[Tracing Module Examples]
* https://help.mulesoft.com[MuleSoft Help Center]
